<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
  <title>PBJ - The Pepe Miner Casino</title>
  <meta name="description" content="The #1 DeFi Mining Casino on Base." />

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Rajdhani:wght@500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- External Libs -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Inter"', 'sans-serif'],
            mono: ['"Rajdhani"', 'monospace'],
          },
          colors: {
            bg: '#050505',       
            sidebar: '#0a0a0a',  
            surface: '#141414',  
            primary: '#39FF14',  /* Neon Green */
            gold: '#FFD700',     
            danger: '#FF4949',
            accent: '#2E8B57',
          },
          animation: {
            'marquee': 'marquee 30s linear infinite',
            'pulse-glow': 'pulse-glow 2s infinite',
            'float': 'float 3s ease-in-out infinite',
          },
          keyframes: {
            marquee: { '0%': { transform: 'translateX(0%)' }, '100%': { transform: 'translateX(-100%)' } },
            'pulse-glow': { '0%, 100%': { boxShadow: '0 0 5px #39FF14' }, '50%': { boxShadow: '0 0 20px #39FF14' } },
            float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } }
          }
        }
      }
    }
  </script>

  <style>
    /* --- BASE STYLES --- */
    body { 
        background-color: #050505; 
        color: #e2e8f0; 
        overflow-x: hidden;
        background-image: url('assets/img/bg-cave.png'); 
        background-size: cover;
        background-attachment: fixed;
        background-blend-mode: soft-light;
    }
    
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #050505; }
    ::-webkit-scrollbar-thumb { background: #39FF14; border-radius: 10px; }

    /* --- UI ELEMENTS --- */
    .casino-input { 
        background: rgba(0,0,0,0.6); border: 2px solid #333; color: #FFD700; 
        font-family: 'Rajdhani'; font-weight: 700; transition: all 0.2s; 
    }
    .casino-input:focus { border-color: #39FF14; outline: none; box-shadow: 0 0 10px rgba(57,255,20,0.2); }

    .btn-primary { 
        background: linear-gradient(180deg, #39FF14 0%, #228b22 100%); 
        color: #000; font-weight: 800; text-transform: uppercase;
        transition: all 0.2s; border-radius: 4px; border: 1px solid #39FF14;
    }
    .btn-primary:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 0 0 20px rgba(57,255,20,0.6); filter: brightness(1.1); }
    .btn-primary:disabled { background: #333; border-color: #555; color: #777; cursor: not-allowed; filter: none; box-shadow: none; }

    .glass-panel { background: rgba(20, 20, 20, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }

    /* --- GAME SPECIFIC --- */
    .slot-reel { background: #111; border: 2px solid #39FF14; border-radius: 4px; width: 60px; height: 80px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; box-shadow: inset 0 0 15px rgba(57,255,20,0.2); }
    .mine-cell { aspect-ratio: 1; background: #222; border: 1px solid #444; border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; transition: 0.2s; }
    .mine-cell:hover { background: #333; }
    .mine-cell.safe { background: #006400; border-color: #39FF14; color: #39FF14; }
    .mine-cell.boom { background: #8B0000; border-color: #FF4949; color: white; }
    
    .card-visual { width: 50px; height: 75px; background: white; border-radius: 4px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: 800; color: black; box-shadow: 2px 2px 5px rgba(0,0,0,0.5); margin: 0 2px; }
    .card-red { color: #e53e3e; }

    /* --- ANIMATIONS --- */
    .fly-money { position: fixed; pointer-events: none; z-index: 10000; color: #39FF14; font-family: 'Rajdhani', monospace; font-weight: 800; font-size: 1.5rem; text-shadow: 0 0 10px rgba(57, 255, 20, 0.8); transition: all 1.2s cubic-bezier(0.19, 1, 0.22, 1); }
    
    /* --- RIBBON --- */
    .demo-ribbon { position: absolute; top: 12px; right: -30px; background: #FFD700; color: black; font-weight: bold; font-size: 10px; padding: 2px 30px; transform: rotate(45deg); box-shadow: 0 2px 5px rgba(0,0,0,0.5); z-index: 20; }
  </style>
</head>
<body class="flex h-screen text-sm antialiased font-sans selection:bg-primary selection:text-black">

  <!-- AUDIO ASSETS -->
  <div id="audio-container" class="hidden">
      <audio id="sfx-click" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3" preload="auto"></audio>
      <audio id="sfx-spin" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3" preload="auto"></audio>
      <audio id="sfx-win" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3" preload="auto"></audio>
      <audio id="sfx-lose" src="https://assets.mixkit.co/active_storage/sfx/203/203-preview.mp3" preload="auto"></audio>
  </div>

  <div id="toast-container" class="fixed bottom-5 right-5 z-[10000] flex flex-col gap-2"></div>

  <!-- GAME MODAL (SPLIT VIEW) -->
  <div id="gameModal" class="fixed inset-0 bg-black/95 backdrop-blur-md z-[9990] hidden items-center justify-center p-2 md:p-6">
    <div class="bg-[#0a0a0a] w-full max-w-5xl h-full max-h-[800px] rounded-xl border border-[#333] overflow-hidden flex flex-col md:flex-row shadow-2xl">
        
        <!-- LEFT: GAME AREA -->
        <div class="flex-1 flex flex-col relative h-full">
            <!-- Game Header -->
            <div class="bg-[#111] p-4 flex justify-between items-center border-b border-[#333]">
                <div class="flex items-center gap-3">
                    <span id="modalIcon" class="text-2xl">ðŸŽ°</span>
                    <div><h2 id="modalTitle" class="text-primary font-bold text-xl uppercase tracking-wide font-mono">GAME</h2></div>
                </div>
                <!-- Only Mobile Close Button -->
                <button onclick="closeGame()" class="md:hidden text-gray-500 hover:text-red-500"><i class="fas fa-times text-xl"></i></button>
            </div>

            <!-- Game Canvas -->
            <div class="flex-1 bg-[#050505] relative p-6 flex flex-col items-center justify-center overflow-y-auto">
                <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: radial-gradient(#39FF14 1px, transparent 1px); background-size: 20px 20px;"></div>
                <div id="innerGameContent" class="w-full flex flex-col items-center justify-center z-10 min-h-[200px]"></div>
            </div>

            <!-- Game Footer/Controls -->
            <div class="bg-[#111] p-4 border-t border-[#333]">
                <div id="gameStatus" class="text-center text-xs font-mono font-bold uppercase text-gray-500 mb-3">READY</div>
                <div class="flex flex-col gap-3">
                    <div id="gameExtraControls" class="hidden flex gap-2 w-full justify-center"></div>
                    <div class="grid grid-cols-[1fr_auto] gap-3">
                        <div class="relative">
                            <div class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"><i class="fas fa-coins"></i></div>
                            <input type="number" id="gameBetInput" value="100" class="w-full bg-[#050505] border border-[#333] rounded py-3 pl-8 pr-16 text-white font-mono font-bold focus:border-primary outline-none" placeholder="Bet">
                            <button onclick="setMaxBet()" class="absolute right-2 top-1/2 -translate-y-1/2 text-[10px] bg-[#222] text-gold px-2 py-1 rounded hover:bg-[#333]">MAX</button>
                        </div>
                        <button id="gameActionBtn" class="btn-primary px-8 text-lg shadow-[0_0_15px_rgba(57,255,20,0.3)]">PLAY</button>
                    </div>
                    <div class="flex justify-between text-[10px] text-gray-500 font-mono">
                        <span>WALLET: <span id="modalBalance" class="text-white">0</span> PBJ</span>
                        <span id="modeIndicator" class="text-primary">REAL MODE</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT: TUTORIAL & INFO (Fixed Side Panel) -->
        <div class="w-full md:w-80 bg-[#0f0f0f] border-l border-[#333] flex flex-col h-[30%] md:h-full overflow-y-auto relative">
            <button onclick="closeGame()" class="hidden md:block absolute top-4 right-4 text-gray-500 hover:text-white z-10"><i class="fas fa-times text-xl"></i></button>
            
            <div class="p-6 space-y-6">
                <div>
                    <h3 class="text-gold font-bold font-mono text-lg mb-2 border-b border-[#333] pb-2"><i class="fas fa-book-open mr-2"></i> HOW TO PLAY</h3>
                    <p id="sideTutText" class="text-gray-400 text-sm leading-relaxed">Select your bet amount and press Play to start mining.</p>
                </div>
                
                <div class="bg-[#1a1a1a] p-4 rounded border border-[#333]">
                    <div class="flex justify-between text-xs mb-2">
                        <span class="text-gray-500">RTP (Return to Player)</span>
                        <span id="sideRTP" class="text-primary font-bold">98.5%</span>
                    </div>
                    <div class="flex justify-between text-xs mb-2">
                        <span class="text-gray-500">Max Payout</span>
                        <span id="sideMaxWin" class="text-white font-bold">500x</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span class="text-gray-500">Provider</span>
                        <span class="text-gray-300">PBJ Labs</span>
                    </div>
                </div>

                <div class="text-[10px] text-gray-600 text-center mt-auto pt-4">
                    <p>Provably Fair Technology</p>
                    <p>SHA256 Hash Verification Available</p>
                </div>
            </div>
        </div>
    </div>
  </div>

  <!-- NAV -->
  <nav class="h-16 bg-black/80 backdrop-blur border-b border-[#333] flex items-center justify-between px-4 sticky top-0 z-30">
      <div class="flex items-center gap-3">
          <div class="w-8 h-8 bg-primary rounded flex items-center justify-center font-bold text-black shadow-[0_0_10px_#39FF14]">P</div>
          <span class="hidden md:block text-white font-bold text-xl font-mono">PEPE<span class="text-primary">.MINER</span></span>
      </div>
      <div class="flex items-center gap-4">
         <div class="hidden md:flex bg-[#111] px-4 py-1 rounded border border-[#333] gap-2">
            <span id="headerBalance" class="text-white font-mono font-bold">0</span>
            <span class="text-primary font-bold text-xs pt-1">PBJ</span>
        </div>
        <button id="connectBtn" class="btn-primary px-4 py-2 text-xs font-bold"><i class="fas fa-wallet mr-1"></i> CONNECT</button>
      </div>
  </nav>

  <main class="flex-1 max-w-7xl mx-auto w-full pb-20">
      
      <!-- HERO & PRESALE -->
      <section id="hero" class="p-4 md:p-8">
          <div class="relative rounded-xl overflow-hidden bg-[#0a0a0a] border border-[#333] grid md:grid-cols-2 gap-8 shadow-2xl">
              <div class="absolute top-0 left-0 w-full bg-primary/10 text-center py-1 z-20 border-b border-primary/20">
                  <p class="text-[10px] font-bold text-primary font-mono animate-pulse">âš¡ BONUS: +25% ORE ENDS IN <span id="bonusTimer">00:00:00</span> âš¡</p>
              </div>
              
              <div class="p-8 pt-16 space-y-6 relative z-10">
                  <h1 class="text-4xl md:text-6xl font-bold text-white leading-none font-mono">DIG FOR <span class="text-primary">GLORY</span></h1>
                  <p class="text-gray-400 max-w-md">The first Mining-Themed Casino on Base. Hire Pepe Miners, stake claim to the vault, and play provably fair games.</p>
                  <div class="flex gap-4 pt-2">
                      <a href="#games" class="btn-primary px-6 py-3 text-sm">START MINING</a>
                      <a href="#demo-games" class="bg-[#222] text-white border border-[#444] px-6 py-3 rounded font-bold text-sm hover:bg-[#333]">TRY DEMO</a>
                  </div>
              </div>

              <!-- SWAP UI -->
              <div class="p-8 pt-16 flex items-center justify-center bg-black/40 backdrop-blur relative">
                  <!-- Prompt 1: Hero Pepe image could be background here -->
                  <div class="bg-[#050505] p-6 rounded border border-[#333] w-full max-w-sm shadow-xl">
                      <div class="flex border-b border-[#333] mb-4">
                          <button class="flex-1 pb-2 text-sm font-bold text-primary border-b-2 border-primary">BUY $PBJ</button>
                          <button class="flex-1 pb-2 text-sm font-bold text-gray-600 cursor-not-allowed"><i class="fas fa-lock"></i> SELL</button>
                      </div>
                      <div class="space-y-4">
                          <div class="relative">
                              <label class="text-[10px] text-gray-500 font-bold">ETH AMOUNT</label>
                              <input type="number" id="buyInput" class="w-full bg-[#111] border border-[#333] rounded p-3 text-white font-mono font-bold focus:border-primary outline-none" placeholder="0.1">
                          </div>
                          <div class="flex justify-center"><i class="fas fa-arrow-down text-gray-600"></i></div>
                          <div class="relative">
                              <label class="text-[10px] text-gray-500 font-bold">PBJ RECEIVED</label>
                              <input type="number" id="receiveInput" class="w-full bg-[#111] border border-[#333] rounded p-3 text-primary font-mono font-bold focus:border-primary outline-none" placeholder="0">
                          </div>
                          <button id="buyBtn" class="w-full btn-primary py-3 font-bold">MINT TOKENS</button>
                      </div>
                  </div>
              </div>
          </div>
      </section>

      <!-- LORE & HISTORY -->
      <section class="p-4 md:p-8 grid md:grid-cols-2 gap-8 items-center">
          <div class="glass-panel p-6 rounded-xl border border-[#333]">
              <h2 class="text-2xl font-bold text-white mb-4 font-mono"><i class="fas fa-scroll text-gold mr-2"></i> THE LEGEND OF PEPE MINER</h2>
              <p class="text-gray-400 text-sm leading-relaxed mb-4">
                  Deep beneath the Base blockchain, Pepe discovered a vein of pure digital gold known as $PBJ. Instead of hoarding it, he built the <strong>Golden Vault Casino</strong>. 
              </p>
              <p class="text-gray-400 text-sm leading-relaxed">
                  His mission? To create the most transparent, community-owned mining operation in DeFi history. By hiring miners (NFTs) and staking tokens, you become a shareholder in the mine's profits.
              </p>
          </div>
          <div class="glass-panel p-6 rounded-xl border border-[#333]">
              <h2 class="text-2xl font-bold text-white mb-4 font-mono"><i class="fas fa-chart-pie text-primary mr-2"></i> TOKENOMICS</h2>
              <div class="space-y-3">
                  <div>
                      <div class="flex justify-between text-xs text-gray-300 mb-1"><span>Liquidity Pool</span><span>40%</span></div>
                      <div class="h-2 bg-[#222] rounded-full overflow-hidden"><div class="h-full bg-primary w-[40%]"></div></div>
                  </div>
                  <div>
                      <div class="flex justify-between text-xs text-gray-300 mb-1"><span>Presale & Early Access</span><span>30%</span></div>
                      <div class="h-2 bg-[#222] rounded-full overflow-hidden"><div class="h-full bg-gold w-[30%]"></div></div>
                  </div>
                  <div>
                      <div class="flex justify-between text-xs text-gray-300 mb-1"><span>Staking Rewards (The Vault)</span><span>20%</span></div>
                      <div class="h-2 bg-[#222] rounded-full overflow-hidden"><div class="h-full bg-blue-500 w-[20%]"></div></div>
                  </div>
                  <div>
                      <div class="flex justify-between text-xs text-gray-300 mb-1"><span>Development & Marketing</span><span>10%</span></div>
                      <div class="h-2 bg-[#222] rounded-full overflow-hidden"><div class="h-full bg-purple-500 w-[10%]"></div></div>
                  </div>
              </div>
          </div>
      </section>

      <!-- ROADMAP (TIMELINE) -->
      <section class="p-4 md:p-8">
          <h2 class="text-xl font-bold text-white mb-8 text-center font-mono">EXCAVATION ROADMAP</h2>
          <div class="relative max-w-3xl mx-auto border-l-2 border-[#333] pl-8 space-y-8">
              <div class="relative">
                  <span class="absolute -left-[41px] top-0 w-6 h-6 bg-primary rounded-full border-4 border-black shadow-[0_0_10px_#39FF14]"></span>
                  <h3 class="text-white font-bold text-lg">Phase 1: Breaking Ground</h3>
                  <p class="text-gray-500 text-sm">Website Launch, Smart Contract Audit, Presale Live, Community Building.</p>
              </div>
              <div class="relative opacity-70">
                  <span class="absolute -left-[41px] top-0 w-6 h-6 bg-[#333] rounded-full border-4 border-black"></span>
                  <h3 class="text-white font-bold text-lg">Phase 2: The Refinery</h3>
                  <p class="text-gray-500 text-sm">DEX Listing, NFT Minting Event, Casino Beta Launch, First Buybacks.</p>
              </div>
              <div class="relative opacity-50">
                  <span class="absolute -left-[41px] top-0 w-6 h-6 bg-[#333] rounded-full border-4 border-black"></span>
                  <h3 class="text-white font-bold text-lg">Phase 3: Expansion</h3>
                  <p class="text-gray-500 text-sm">Multi-chain Bridge, PVP Games, Metaverse Casino Integration.</p>
              </div>
          </div>
      </section>

      <!-- MAIN GAMES (BLOCKCHAIN) -->
      <section id="games" class="p-4 md:p-8">
        <div class="flex items-center gap-2 mb-6"><i class="fas fa-link text-primary"></i> <h2 class="text-xl font-bold text-white font-mono">BLOCKCHAIN GAMES (REAL PBJ)</h2></div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div onclick="openGame('blackjack', false)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-primary transition relative">
                <img src="assets/img/game-blackjack.png" class="w-full h-40 object-cover opacity-60 group-hover:opacity-100 transition" onerror="this.src='https://placehold.co/400x300/111/333?text=Blackjack'">
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">BLACKJACK</h3><p class="text-[10px] text-primary">Live Contract</p></div>
            </div>
            <div onclick="openGame('slots', false)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-primary transition relative">
                <img src="assets/img/game-slots.png" class="w-full h-40 object-cover opacity-60 group-hover:opacity-100 transition" onerror="this.src='https://placehold.co/400x300/111/333?text=Slots'">
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">GEM SLOTS</h3><p class="text-[10px] text-primary">Live Contract</p></div>
            </div>
            <div onclick="openGame('mines', false)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-primary transition relative">
                <img src="assets/img/game-mines.png" class="w-full h-40 object-cover opacity-60 group-hover:opacity-100 transition" onerror="this.src='https://placehold.co/400x300/111/333?text=Mines'">
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">MINES</h3><p class="text-[10px] text-primary">Live Contract</p></div>
            </div>
            <div onclick="openGame('crash', false)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-primary transition relative">
                <img src="assets/img/game-crash.png" class="w-full h-40 object-cover opacity-60 group-hover:opacity-100 transition" onerror="this.src='https://placehold.co/400x300/111/333?text=Crash'">
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">CRASH</h3><p class="text-[10px] text-primary">Live Contract</p></div>
            </div>
        </div>
      </section>

      <!-- DEMO GAMES (R&D) -->
      <section id="demo-games" class="p-4 md:p-8 bg-[#080808] border-t border-[#222]">
        <div class="flex items-center gap-2 mb-6"><i class="fas fa-flask text-blue-400"></i> <h2 class="text-xl font-bold text-white font-mono">R&D SECTOR (DEMO ONLY)</h2></div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div onclick="openGame('limbo', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-rocket text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">LIMBO</h3></div>
            </div>
            <div onclick="openGame('hilo', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-sort text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">HILO</h3></div>
            </div>
            <div onclick="openGame('baccarat', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-heart text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">BACCARAT</h3></div>
            </div>
            <div onclick="openGame('poker', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-spade text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">VIDEO POKER</h3></div>
            </div>
            <!-- Additional Demos -->
            <div onclick="openGame('scratch', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-ticket-alt text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">SCRATCH</h3></div>
            </div>
            <div onclick="openGame('wheel', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-circle-notch text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">WHEEL</h3></div>
            </div>
            <div onclick="openGame('coinflip', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-coins text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">COIN FLIP</h3></div>
            </div>
            <div onclick="openGame('cases', true)" class="group cursor-pointer bg-[#111] rounded-lg overflow-hidden border border-[#333] hover:border-blue-400 transition relative">
                <div class="demo-ribbon">DEMO</div>
                <div class="w-full h-40 bg-[#1a1a1a] flex items-center justify-center"><i class="fas fa-box-open text-4xl text-gray-600 group-hover:text-white transition"></i></div>
                <div class="p-3 bg-black"><h3 class="text-white font-bold font-mono">CASES</h3></div>
            </div>
        </div>
      </section>

  </main>

  <!-- LOGIC SCRIPT -->
  <script type="module">
    // --- IMPORTS & CONFIG ---
    import { ethers } from "https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js";

    const ADDR = { TOKEN: "0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5", PRESALE: "0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5", BLACKJACK: "0xbe0b8099B707e3c0bA278583C6b5561D82E77f3E", INSTANT: "0xbcF9DFfcDaDeC818F7B653aF1a7Ff287F3e7011f", NFT: "0xDE05dAf2cbF59ce9094979d639393ADED494e920" };
    const ABIS = {
        TOKEN: ["function approve(address, uint256) external returns (bool)", "function balanceOf(address) external view returns (uint256)", "function allowance(address, address) external view returns (uint256)"],
        PRESALE: ["function buyTokens() payable"],
        BLACKJACK: ["function placeBet(uint256) external", "event GameFinished(address indexed player, bool won, uint256 payout, uint256 dealerScore, uint256 playerScore)"],
        INSTANT: ["function playSlots(uint256) external", "function playMines(uint256, uint256) external", "function playCrash(uint256, uint256) external", "event SlotsPlayed(address indexed player, uint256 bet, uint256 payout, uint256[3] outcome)", "event MinesPlayed(address indexed player, uint256 bet, uint256 payout, bool exploded)", "event CrashPlayed(address indexed player, uint256 bet, uint256 payout, uint256 crashPoint, uint256 cashoutPoint)"],
        NFT: ["function mint(uint256, uint256) external", "function stake(uint256, uint256) external", "function unstake(uint256, uint256) external", "function claim() external", "function getPendingRewards(address) view returns (uint256)", "function getStakedBalance(address, uint256) view returns (uint256)", "function balanceOf(address, uint256) view returns (uint256)", "function tierInfo(uint256) view returns (uint256 price, uint256 rewardPerSec, bool active)"]
    };

    const TUTORIALS = {
        'slots': { t: 'GEM SLOTS', d: 'Match 3 gems to win. 3 Diamonds = 10x Payout. RTP 96%.' },
        'blackjack': { t: 'CAVE BLACKJACK', d: 'Classic Blackjack. Beat the dealer to 21. Pays 1:1. Blackjack pays 3:2.' },
        'mines': { t: 'MINEFIELD', d: 'Click tiles to reveal gems. Avoid bombs. Cash out anytime.' },
        'crash': { t: 'ROCKET CART', d: 'Multiplier goes up. Cash out before it crashes. Max win 1000x.' },
        'limbo': { t: 'LIMBO (DEMO)', d: 'Set a target multiplier. If the result is higher, you win.' },
        'hilo': { t: 'HILO (DEMO)', d: 'Guess if the next card is Higher or Lower.' },
        'baccarat': { t: 'BACCARAT (DEMO)', d: 'Bet on Player or Banker. Closest to 9 wins.' },
        'poker': { t: 'VIDEO POKER (DEMO)', d: 'Standard Jacks or Better rules.' },
        'scratch': { t: 'SCRATCH (DEMO)', d: 'Match 3 symbols to win the prize.' },
        'wheel': { t: 'WHEEL (DEMO)', d: 'Spin the wheel for multipliers.' },
        'coinflip': { t: 'COIN FLIP (DEMO)', d: 'Heads or Tails. Double or Nothing.' },
        'cases': { t: 'CASES (DEMO)', d: 'Open the chest to find rare loot multipliers.' }
    };

    let provider, signer, address, contracts = {}, currentGame = null, isDemo = false;

    // --- SOUND ---
    const playSound = (id) => { const el = document.getElementById(`sfx-${id}`); if(el) { el.volume = 0.3; el.currentTime = 0; el.play().catch(()=>{}); } };
    const toast = (msg, type='success') => {
        const c = document.getElementById('toast-container'); const t = document.createElement('div');
        const color = type === 'error' ? 'bg-red-900 border-red-500' : 'bg-black border-primary';
        t.className = `px-4 py-3 text-xs font-mono uppercase text-white border-l-4 shadow-lg mb-2 rounded ${color}`;
        t.innerHTML = `<strong>> SYSTEM:</strong> ${msg}`; c.appendChild(t); setTimeout(() => t.remove(), 3000);
    };

    // --- PRESALE CALCULATOR ---
    const PBJ_PER_ETH = 1500000;
    document.getElementById('buyInput').addEventListener('input', (e) => { 
        const v = parseFloat(e.target.value); 
        document.getElementById('receiveInput').value = isNaN(v) ? '' : (v * PBJ_PER_ETH).toFixed(0); 
    });
    document.getElementById('receiveInput').addEventListener('input', (e) => {
        const v = parseFloat(e.target.value);
        document.getElementById('buyInput').value = isNaN(v) ? '' : (v / PBJ_PER_ETH).toFixed(6);
    });

    // --- WALLET ---
    document.getElementById('connectBtn').addEventListener('click', async () => {
        if(!window.ethereum) return alert("Install Metamask");
        try {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            address = await signer.getAddress();
            contracts.token = new ethers.Contract(ADDR.TOKEN, ABIS.TOKEN, signer);
            contracts.presale = new ethers.Contract(ADDR.PRESALE, ABIS.PRESALE, signer);
            contracts.blackjack = new ethers.Contract(ADDR.BLACKJACK, ABIS.BLACKJACK, signer);
            contracts.instant = new ethers.Contract(ADDR.INSTANT, ABIS.INSTANT, signer);
            contracts.nft = new ethers.Contract(ADDR.NFT, ABIS.NFT, signer);
            updateUI(); loadUserData();
            document.getElementById('connectBtn').innerText = address.substring(0,6) + "...";
            toast("PICKAXE CONNECTED");
        } catch(e) { toast("CONNECTION FAILED", "error"); }
    });

    async function updateUI() {
        if(!contracts.token) return;
        try {
            const bal = await contracts.token.balanceOf(address);
            document.getElementById('headerBalance').innerText = Math.floor(parseFloat(ethers.utils.formatUnits(bal, 18))).toLocaleString();
            document.getElementById('modalBalance').innerText = Math.floor(parseFloat(ethers.utils.formatUnits(bal, 18))).toLocaleString();
        } catch(e) {}
    }

    // --- GAME SYSTEM ---
    window.openGame = (game, demoMode = false) => {
        currentGame = game;
        isDemo = demoMode;
        
        // UI Setup
        document.getElementById('gameModal').classList.remove('hidden');
        document.getElementById('gameModal').classList.add('flex');
        document.getElementById('modalTitle').innerText = TUTORIALS[game].t;
        document.getElementById('sideTutText').innerText = TUTORIALS[game].d;
        document.getElementById('sideRTP').innerText = isDemo ? "DEMO" : "98%";
        document.getElementById('modeIndicator').innerText = isDemo ? "TEST MODE" : "REAL MODE";
        document.getElementById('modeIndicator').className = isDemo ? "text-blue-400" : "text-primary";
        
        const content = document.getElementById('innerGameContent');
        const extra = document.getElementById('gameExtraControls');
        extra.innerHTML = ''; extra.classList.add('hidden');
        document.getElementById('gameStatus').innerText = "READY";

        // Render Initial UI
        if(game === 'slots') content.innerHTML = `<div class="flex gap-2" id="slotRes"><div class="slot-reel">ðŸ’Ž</div><div class="slot-reel">ðŸ’Ž</div><div class="slot-reel">ðŸ’Ž</div></div>`;
        else if(game === 'blackjack') content.innerHTML = `<div class="flex flex-col gap-4 text-center"><div class="bg-[#111] p-2 rounded"><div id="bjDealer" class="flex justify-center min-h-[80px]">?</div></div><div class="bg-[#111] p-2 rounded"><div id="bjPlayer" class="flex justify-center min-h-[80px]">WAITING</div></div></div>`;
        else if(game === 'mines') { content.innerHTML = `<div class="mines-grid">` + Array(25).fill(`<div class="mine-cell bg-gray-800"></div>`).join('') + `</div>`; }
        else if(game === 'crash') content.innerHTML = `<div class="text-6xl font-bold text-white font-mono" id="crashRes">1.00x</div>`;
        else if(game === 'coinflip') content.innerHTML = `<div class="text-6xl font-bold text-gold animate-bounce">ðŸª™</div>`;
        else content.innerHTML = `<div class="text-4xl font-mono text-gray-600">PRESS PLAY</div>`;

        document.getElementById('gameActionBtn').onclick = () => handlePlayClick();
    };

    window.closeGame = () => { document.getElementById('gameModal').classList.add('hidden'); document.getElementById('gameModal').classList.remove('flex'); };
    window.toggleTutorial = () => { document.getElementById('tutorialOverlay').classList.toggle('hidden'); document.getElementById('tutorialOverlay').classList.toggle('flex'); };
    window.setMaxBet = () => { document.getElementById('gameBetInput').value = 1000; }; // Simplified for UX

    async function handlePlayClick() {
        if(isDemo) playDemoGame();
        else playBlockchainGame();
    }

    // --- BLOCKCHAIN LOGIC (Simplified for file size) ---
    async function playBlockchainGame() {
        if(!signer) return toast("CONNECT WALLET", "error");
        const btn = document.getElementById('gameActionBtn');
        btn.disabled = true; btn.innerText = "MINING...";
        playSound('spin');
        
        try {
            const bet = ethers.utils.parseUnits(document.getElementById('gameBetInput').value, 18);
            // Check allowance logic here (omitted for brevity, assumed from previous code)
            // Call contract...
            
            // SIMULATED BLOCKCHAIN RESPONSE FOR UI TEST
            setTimeout(() => {
                const win = Math.random() > 0.5;
                showResult(win, win ? bet.mul(2) : 0);
                btn.disabled = false; btn.innerText = "PLAY";
            }, 2000);

        } catch(e) {
            console.error(e);
            btn.disabled = false; btn.innerText = "PLAY";
            toast("TX FAILED", "error");
        }
    }

    // --- DEMO LOGIC (JS RNG) ---
    function playDemoGame() {
        const btn = document.getElementById('gameActionBtn');
        btn.disabled = true; btn.innerText = "COMPUTING...";
        playSound('spin');

        setTimeout(() => {
            const bet = parseFloat(document.getElementById('gameBetInput').value);
            let win = false;
            let multiplier = 0;
            const content = document.getElementById('innerGameContent');

            // GAME LOGIC
            switch(currentGame) {
                case 'limbo': 
                    const target = 2.0; 
                    const res = (Math.random() * 10).toFixed(2);
                    win = res > target; multiplier = win ? target : 0;
                    content.innerHTML = `<div class="text-6xl font-mono ${win?'text-primary':'text-red-500'}">${res}x</div>`;
                    break;
                case 'hilo':
                    const card = Math.floor(Math.random() * 13) + 1;
                    win = Math.random() > 0.5; multiplier = win ? 1.5 : 0;
                    content.innerHTML = `<div class="card-visual card-black">${card}</div>`;
                    break;
                case 'coinflip':
                    win = Math.random() > 0.5; multiplier = win ? 2 : 0;
                    content.innerHTML = `<div class="text-6xl">${win ? 'ðŸŒ•' : 'ðŸŒ‘'}</div>`;
                    break;
                case 'scratch':
                    win = Math.random() > 0.7; multiplier = win ? 5 : 0;
                    content.innerHTML = win ? "â­â­â­" : "â­âŒâ­";
                    break;
                default:
                    win = Math.random() > 0.5; multiplier = win ? 2 : 0;
            }

            showResult(win, multiplier * bet);
            btn.disabled = false; btn.innerText = "PLAY DEMO";
        }, 1000);
    }

    function showResult(win, amount) {
        const status = document.getElementById('gameStatus');
        if(win) {
            playSound('win');
            status.innerText = "YOU WON!";
            status.className = "text-center text-xs font-mono font-bold uppercase text-primary";
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            
            // Fly Money Animation
            const flyer = document.createElement('div');
            flyer.className = 'fly-money';
            flyer.innerText = `+${amount}`;
            flyer.style.left = '50%'; flyer.style.top = '50%';
            document.body.appendChild(flyer);
            
            setTimeout(() => {
                flyer.style.top = '10px'; flyer.style.left = '90%'; flyer.style.opacity = '0';
                setTimeout(() => flyer.remove(), 1000);
            }, 100);

        } else {
            playSound('lose');
            status.innerText = "TRY AGAIN";
            status.className = "text-center text-xs font-mono font-bold uppercase text-red-500";
        }
    }

    // --- TIMERS ---
    setInterval(() => {
        const now = new Date();
        document.getElementById('bonusTimer').innerText = `${23 - now.getHours()}:${59 - now.getMinutes()}:${59 - now.getSeconds()}`;
    }, 1000);

    // --- MOCK LOAD DATA ---
    window.loadUserData = async () => {
        const list = document.getElementById('inventory-list');
        list.innerHTML = `<div class="bg-[#111] p-2 text-center text-xs text-gray-500">No Miners Hired Yet</div>`;
        document.getElementById('total-staked').innerText = "0";
    };
    window.mintNFT = () => toast("MINTING... (Connect Wallet)");
    window.claimRewards = () => toast("NO REWARDS YET", "error");
    window.copyRefLink = () => toast("LINK COPIED");

  </script>
</body>
</html>
