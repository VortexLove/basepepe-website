<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Pepe Blackjack (PBJ) - DApp</title>
  <meta name="description" content="Presale + Blackjack + NFTs on Base. Pepe Blackjack (PBJ) token and Web3 casino." />
  <meta http-equiv="x-ua-compatible" content="IE=edge" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />

  <!-- Scripts -->
  <script defer src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script defer src="./cdn.tailwindcss.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>

  <style>
    :root { color-scheme: dark; scroll-behavior:smooth; }
    html, body { margin:0; padding:0; background:#000; }
    html, body, * { font-family:'Press Start 2P', cursive !important; }
    body { -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility; }
    img { max-width:100%; height:auto; display:block; }

    /* Particles */
    #tsparticles { position:fixed; z-index:-1; inset:0; width:100%; height:100%; pointer-events:none; }

    /* Navigation */
    .nav-wrap { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; }
    .nav-btn {
      background:#0f2b1c; color:#a9ffcf; border:2px solid #1e5a3c;
      padding:6px 10px; border-radius:8px; font-size:10px; cursor:pointer;
      box-shadow:0 0 8px #39ff1433, 2px 2px 0 #001c0d;
      transition:transform .15s, box-shadow .15s, background .3s;
      text-decoration:none;
      position:relative;
      overflow:hidden;
      display:inline-flex; align-items:center; gap:6px;
    }
    .nav-btn::after{
      content:""; position:absolute; inset:0;
      background:radial-gradient(circle at 30% 20%,#39ff1411,transparent 60%);
      opacity:0; transition:opacity .35s;
    }
    .nav-btn:hover {
      transform:translateY(-3px);
      box-shadow:0 0 14px #39ff14, 4px 4px 0 #001c0d;
    }
    .nav-btn:hover::after{ opacity:1; }
    .nav-btn.active {
      background:#39ff14; color:#042414; border-color:#0d4d31;
      box-shadow:0 0 16px #39ff1499, 2px 2px 0 #042414;
    }

    /* Panels */
    .pixel-panel, .content-panel {
      position:relative; background:#0a1114; border-radius:20px;
      padding:28px 24px; box-shadow:0 0 0 3px #0d1e15 inset, 0 14px 30px rgba(0,0,0,.6), 0 0 42px #39ff1428;
      border:3px solid #123b27;
      backdrop-filter:blur(6px);
    }
    .pixel-panel::before, .content-panel::before {
      content:""; position:absolute; inset:-3px; border-radius:22px; z-index:-1;
      background:conic-gradient(from 0deg,#39ff14,#00ffa5,#39ff14);
      filter:blur(18px); opacity:.18;
      animation:spinGlow 14s linear infinite;
    }
    @keyframes spinGlow { to { transform:rotate(360deg);} }

    .section-title {
      margin-top:0; margin-bottom:18px; font-size:20px;
      color:#39ff14; text-shadow:0 0 6px #39ff14;
      display:flex; align-items:center; gap:10px; justify-content:flex-start;
      position:relative;
    }
    .section-title .neon-underline {
      position:absolute; left:0; bottom:-6px; height:2px; width:140px;
      background:linear-gradient(90deg,transparent,#39ff14,transparent);
      filter:drop-shadow(0 0 6px #39ff14);
      animation: shimmer 2.6s linear infinite;
    }
    @keyframes shimmer {
      0% { transform:translateX(-30%); opacity:.6; }
      50% { transform:translateX(30%); opacity:1; }
      100% { transform:translateX(100%); opacity:.6; }
    }
    .content-panel p, .content-panel li { font-size:12px; line-height:1.55; }

    /* Hero (Buy + Timers + Vote + Promo Image) */
    .hero-grid {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:32px;
    }
    @media (max-width:900px){
      .hero-grid { grid-template-columns:1fr; }
    }
    .hero-subpanels {
      display:flex;
      flex-direction:column;
      gap:18px;
    }

    .hero-promo {
      background:#071610;
      border:2px solid #164a33;
      border-radius:16px;
      padding:12px;
      box-shadow:0 0 0 3px #0d1e15 inset, 0 0 22px #39ff1426;
      animation:fadeSlide .7s ease forwards;
      opacity:0; transform:translateY(12px);
    }
    .hero-promo img {
      width:100%; height:auto; border-radius:12px; border:2px solid #1e5a3c;
      box-shadow:inset 0 0 16px #0c2d20, 0 10px 30px #000000aa, 0 0 24px #39ff1422;
    }

    .mini-box {
      background:#091a15;
      border:2px solid #164a33;
      border-radius:16px;
      padding:18px 20px;
      box-shadow:0 0 0 3px #0d1e15 inset, 0 0 18px #39ff1433;
      position:relative;
      overflow:hidden;
    }
    .mini-box::before{
      content:""; position:absolute; inset:0;
      background:
        radial-gradient(circle at 15% 25%,#39ff1418,transparent 60%),
        radial-gradient(circle at 85% 75%,#39ff1412,transparent 65%);
      opacity:.55;
      animation:floatBG 7s ease-in-out infinite alternate;
      pointer-events:none;
    }
    @keyframes floatBG { 0%{transform:translateY(0)} 100%{transform:translateY(-10px)} }
    .progress-rail {
      width:100%; height:14px; background:#2c3840; border-radius:10px; overflow:hidden;
      box-shadow:inset 0 0 4px #000;
      position:relative;
    }
    .progress-bar {
      height:100%; width:0%; background:linear-gradient(90deg,#39ff14,#00ffa5);
      box-shadow:0 0 6px #39ff14;
      transition:width .6s ease;
      position:relative;
    }
    .progress-bar::after {
      content:""; position:absolute; top:0; bottom:0; width:80px;
      background:linear-gradient(90deg,transparent,#ffffff66 60%,transparent);
      animation:barShine 2.8s linear infinite;
    }
    @keyframes barShine { 0%{left:-80px;} 100%{left:100%;} }
    .countdown-text {
      font-size:20px; color:#39ff14; text-align:center; margin-top:10px;
      text-shadow:0 0 6px #39ff14;
      /* QUITAR efecto de zoom: antes se usaba pulseSoft, ahora desactivado */
      /* animation:pulseSoft 2.8s ease-in-out infinite; */
    }

    .collected-text {
      font-size:20px; color:#60a5ff; text-align:center; margin-top:10px;
      text-shadow:0 0 6px #60a5ff;
      /* Quitar zoom/pulso */
      /* animation:pulseBlue 3.2s ease-in-out infinite; */
    }

    .vote-emojis button {
      background:none; border:none; cursor:pointer; font-size:26px;
      filter:drop-shadow(0 0 3px #39ff14);
      transition:transform .2s;
    }
    .vote-emojis button:hover { transform:translateY(-2px); } /* sin scale para evitar zoom */

    /* Tokenomics bars + legend */
    .tokenomics-bar {
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px; border-radius:10px; color:#000; font-weight:700; text-transform:uppercase;
      box-shadow:3px 3px 0 #00000066; border:3px solid #111;
    }
    .tokenomics-bar .pct { background:#000; color:#fff; padding:4px 8px; border-radius:6px; font-size:12px; }
    .bar-purple{background:#B69CFF;} .bar-green{background:#39FF14;} .bar-blue{background:#76C7FF;}
    .bar-orange{background:#FFA726;} .bar-yellow{background:#FCD34D;}

    .pizza-box { position:relative; }
    .pizza-lid {
      background:#f0c27b; border:4px solid #7a4e1b; border-bottom:0; padding:10px;
      border-top-left-radius:6px; border-top-right-radius:6px; text-shadow:1px 1px 0 #00000033;
    }
    .pizza-base {
      background:#e2b47a; border:4px solid #7a4e1b; border-top:0; padding:18px;
      border-bottom-left-radius:6px; border-bottom-right-radius:6px; display:flex; justify-content:center;
    }
    .pizza-chart {
      width:260px; height:260px; max-width:80vw; max-height:80vw; border-radius:50%; position:relative;
      box-shadow:inset 0 0 0 8px #7a4e1b, 2px 2px 0 #00000055;
      animation:spinUtility 22s linear infinite;
    }
    .pizza-chart::after {
      content:""; position:absolute; inset:20%; background:#d9a36a; border-radius:50%; box-shadow:inset 0 0 0 4px #7a4e1b;
    }
    @keyframes spinUtility { 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }
    .legend-item {
      display:flex; align-items:center; gap:10px; background:#111827; border:1px solid #1f2937; padding:8px 10px; border-radius:8px;
      font-size:11px;
      animation:fadeSlide .9s ease forwards;
      opacity:0; transform:translateY(10px);
    }
    .legend-dot { width:14px; height:14px; border-radius:3px; box-shadow:1px 1px 0 #00000055; }

    /* NFT cards */
    .nft-section {
      display:flex; justify-content:center; gap:24px; flex-wrap:nowrap; overflow-x:auto;
      padding:20px; max-width:100%; scroll-snap-type:x mandatory; scroll-behavior:smooth;
    }
    .nft-card { flex:0 0 260px; padding:14px; border-radius:10px; background:transparent; display:flex; flex-direction:column; align-items:center; scroll-snap-align:start; }
    .pixel-frame {
      position:relative; width:100%; padding:14px; background:#0b0f12;
      border:3px solid #0f2b1c;
      box-shadow:0 0 0 3px #0c1e14 inset, 0 0 22px #39ff1499, 4px 4px 0 #001c0d;
      border-radius:10px; transition:transform .12s ease, box-shadow .12s ease;
    }
    .pixel-frame::before, .pixel-frame::after {
      content:""; position:absolute; inset:-3px; border-radius:10px;
      background:conic-gradient(from 0deg,#39ff14,#00ffa5,#39ff14);
      filter:blur(8px); opacity:.12; z-index:-1;
    }
    .pixel-frame:hover { transform:translateY(-4px); box-shadow:0 0 0 3px #0c1e14 inset, 0 0 28px #39ff14, 8px 8px 0 #001c0d; }
    .nft-badge {
      display:inline-flex; align-items:center; gap:8px;
      background:#072818; border:2px solid #1e5a3c; color:#a9ffcf; padding:6px 8px; border-radius:8px; font-size:12px; margin-bottom:10px;
      box-shadow:0 0 8px #39ff1433;
      /* eliminar zoom del bounceIn */
      animation:fadeSlide .6s ease forwards;
      opacity:0; transform:translateY(12px);
    }

    /* PRICE overlay sobre la imagen */
    .nft-image-wrap { position:relative; }
    .price-tag {
      position:absolute; top:8px; right:8px;
      background:#39ff14; color:#052515; border:2px solid #0e3e28;
      border-radius:10px; padding:4px 8px; font-size:11px; box-shadow:0 0 8px #39ff1480;
    }

    .nft-card h2, .nft-card p { color:#22c55e; font-size:16px; text-align:center; }
    .nft-card p { font-size:13px; color:#b8ffda; }
    .nft-card img {
      width:100%; max-width:220px; margin:10px auto 16px; image-rendering:pixelated;
      border-radius:8px; border:2px solid #173d2b; background:#04130c;
      box-shadow:inset 0 0 20px #093b25, 0 10px 20px rgba(0,0,0,.6);
    }
    .pixel-button {
      background:#00FF00; border:2px solid #003300; color:#000; font-size:11px; padding:10px 14px; cursor:pointer;
      box-shadow:2px 2px 0 #003300; transition:transform .1s, filter .3s;
      width:100%;
    }
    .pixel-button:hover { transform:translateY(-2px); filter:brightness(1.05); } /* sin scale */

    @media (max-width:500px){
      .nft-section{gap:12px;padding:12px;}
      .nft-card{flex:0 0 200px;padding:6px;}
      .nft-card img{max-width:180px;}
    }

    /* Staking lists */
    #userNFTs, #stakedNFTs, #userNFTsStake { scroll-snap-type:x mandatory; }
    #userNFTs > div, #stakedNFTs > div, #userNFTsStake > div {
      scroll-snap-align:start; flex:0 0 220px; background:#111; border:2px solid #22c55e; border-radius:12px; padding:12px;
      text-align:center; color:#a6f4a6; box-shadow:0 0 8px #22c55e88; font-size:11px;
      transition:transform .25s;
    }
    #userNFTs > div:hover, #stakedNFTs > div:hover, #userNFTsStake > div:hover { transform:translateY(-6px); }

    #userNFTs button, #stakedNFTs button, #userNFTsStake button {
      margin-top:10px; background-color:#00ff00; color:#000; font-size:10px; padding:6px 10px; border:2px solid #003300; cursor:pointer;
      box-shadow:2px 2px 0 #003300; border-radius:4px; transition:transform .1s;
    }
    #userNFTs button:hover, #stakedNFTs button:hover, #userNFTsStake button:hover { transform:translateY(-2px); } /* sin scale */

    /* Blackjack reused styles */
    .card {
      position:relative; width:90px; height:130px; background:#fff; border:3px solid #111; border-radius:10px;
      box-shadow:0 6px 10px rgba(0,0,0,.55), inset 0 0 0 2px #eee;
      display:flex; align-items:center; justify-content:center;
      font-size:1.9rem; font-weight:700; opacity:0; transform:translateY(-10px); transition:opacity .35s, transform .35s;
    }
    .card.reveal { opacity:1; transform:translateY(0); }
    .card .corner { position:absolute; font-size:.75rem; line-height:1; font-weight:700; }
    .card .top-left { top:6px; left:6px; }
    .card .bottom-right { bottom:6px; right:6px; transform:rotate(180deg); }
    .red { color:#d60000; } .black { color:#111; }

    /* BACK of card to pre-poblar zona */
    .card.back {
      background:repeating-linear-gradient(45deg,#0a2f1e 0 10px,#0f5135 10px 20px);
      color:#eafff1;
    }
    .card.back::before {
      content:"PBJ"; position:absolute; inset:auto; top:8px; left:8px; font-size:.7rem; opacity:.9;
      background:#072818; color:#39ff14; border:2px solid #39ff14; border-radius:8px; padding:2px 6px; box-shadow:0 0 6px #39ff14aa;
    }

    @media (min-width:640px){ .card { width:110px; height:155px; font-size:2.3rem; } }
    @media (max-width:480px){ .card { width:70px; height:100px; font-size:1.4rem; } }

    .blackjack-wrapper {
      background:radial-gradient(circle at 50% 35%, #0f3d26 0%, #062014 55%, #02120b 100%);
      border:4px solid #0a4d31; border-radius:24px; padding:18px 14px 26px;
      box-shadow:0 10px 30px rgba(0,0,0,.7), 0 0 0 3px #113d28, inset 0 0 30px #0c5134;
      position:relative; overflow:hidden;
    }
    .blackjack-wrapper::before {
      content:"PBJ BLACKJACK"; position:absolute; top:8px; left:50%; transform:translateX(-50%);
      font-size:.65rem; letter-spacing:3px; color:#39ff14cc; text-shadow:0 0 6px #39ff14, 0 0 14px #39ff1480;
      pointer-events:none;
    }
    .floating-glow { position:absolute; inset:0; pointer-events:none;
      background:
        radial-gradient(circle at 20% 30%, #39ff1425 0, transparent 45%),
        radial-gradient(circle at 80% 70%, #39ff1425 0, transparent 45%);
      /* Quitar pulso (no zoom) */
      /* animation:glowPulse 4s ease-in-out infinite; */
      opacity:.75;
    }

    .hand-row { display:flex; justify-content:center; align-items:flex-end; gap:8px; flex-wrap:nowrap; overflow-x:auto; padding:8px 4px; min-height:142px; }
    .score-badge {
      background:#072818; border:2px solid #39ff14; color:#39ff14; padding:6px 10px; border-radius:12px; font-size:.65rem;
      display:inline-flex; align-items:center; gap:6px; box-shadow:0 0 8px #39ff14;
    }
    .score-badge .chip { width:18px; height:18px; background:conic-gradient(#39ff14,#072818,#39ff14); border:2px solid #39ff14; border-radius:50%; box-shadow:0 0 4px #39ff1480; }
    .divider-line { height:2px; background:linear-gradient(90deg,#39ff1400,#39ff14 35%,#39ff14 65%,#39ff1400); margin:12px 0; filter:drop-shadow(0 0 6px #39ff14); }

    .bet-panel {
      display:flex; flex-direction:column; gap:6px; background:#0a2f1e; border:3px solid #124c31; padding:12px; border-radius:14px;
      box-shadow:0 4px 12px #00000080, inset 0 0 12px #0f5135;
    }
    .bet-panel label { font-size:.7rem; color:#a3ffce; }
    .bet-panel input {
      background:#143e2a; border:2px solid #206246; color:#e8ffe8; padding:6px 8px; border-radius:8px; font-size:.8rem; width:100%;
      transition:border-color .2s, box-shadow .2s;
    }
    .bet-panel input:focus { outline:none; border-color:#39ff14; box-shadow:0 0 0 2px #39ff1420; }
    .bet-status { font-size:.65rem; min-height:1.2em; color:#39ff14; }
    .bet-status.error { color:#ff5151; }

    .btn-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(110px,1fr)); gap:8px; margin-top:10px; }
    .bj-btn {
      background:linear-gradient(180deg,#1c7f55,#14573b); border:2px solid #39ff14; color:#eafff1; padding:10px 8px; font-size:.75rem; border-radius:12px;
      cursor:pointer; position:relative; overflow:hidden; transition:.25s transform,.25s box-shadow,.25s background;
    }
    .bj-btn:hover:not([disabled]) { transform:translateY(-4px); box-shadow:0 6px 14px #000, 0 0 10px #39ff1490; }
    .bj-btn:disabled { opacity:.45; cursor:not-allowed; }
    .bj-btn.secondary { background:linear-gradient(180deg,#173d2b,#0b2317); border-color:#206246; color:#9dddbd; }
    .bj-btn.cancel { background:linear-gradient(180deg,#5d1313,#3b0b0b); border-color:#ff5858; color:#ffe5e5; }

    .result-banner { margin-top:14px; background:#072818; border:2px solid #206246; padding:10px 14px; border-radius:14px;
      font-size:.8rem; color:#e8ffe8; text-align:center; min-height:52px; }
    .result-banner.win { border-color:#39ff14; box-shadow:0 0 10px #39ff14; color:#39ff14; }
    .result-banner.lose { border-color:#ff5151; box-shadow:0 0 10px #ff5151; color:#ff9090; }
    .result-banner.push { border-color:#00aaff; box-shadow:0 0 10px #00aaff; color:#7fd7ff; }

    /* Buy panel extras */
    .panel-sub { display:flex; justify-content:space-between; font-size:.7rem; color:#a8ffcf; margin-bottom:8px; }
    .rate-badge {
      display:inline-flex; gap:6px; align-items:center; background:#072818; border:2px solid #1e5a3c; color:#a9ffcf; padding:6px 8px; border-radius:8px; font-size:.7rem;
      animation:fadeSlide .8s ease forwards; opacity:0; transform:translateY(10px);
    }
    .quick-row { display:flex; flex-wrap:wrap; gap:8px; margin:10px 0 6px; }
    .quick-chip {
      background:#0f2b1c; color:#a8ffcf; border:2px solid #1e5a3c; padding:6px 8px; border-radius:8px; font-size:.7rem; cursor:pointer;
      box-shadow:0 0 8px #39ff1433; transition:background .2s, transform .15s;
    }
    .quick-chip:hover { background:#143e2a; transform:translateY(-2px); }
    .max-btn {
      margin-left:auto; background:#39ff14; color:#07140e; border:2px solid #0e3e28; padding:6px 10px; border-radius:8px; font-size:.7rem; cursor:pointer; box-shadow:2px 2px 0 #003300;
      transition:transform .15s;
    }
    .max-btn:hover { transform:translateY(-2px); }

    .cta-btn {
      width:100%; padding:14px 12px; border-radius:14px;
      background:linear-gradient(180deg,#2aff5a,#1aa746);
      color:#03130b; border:2px solid #103e29; font-weight:700; letter-spacing:1px;
      box-shadow:0 8px 0 #0a3a24, 0 0 18px #39ff1499; cursor:pointer; transition:transform .12s ease, box-shadow .25s;
    }
    .cta-btn:hover { transform:translateY(-3px); box-shadow:0 12px 0 #0a3a24, 0 0 26px #39ff14; }
    .cta-btn:disabled { filter:grayscale(.6); opacity:.55; cursor:not-allowed; }

    .mini-note { font-size:.65rem; color:#b8ffda; opacity:.9; text-align:center; margin-top:6px; }
    .mini-sep { height:2px; margin:12px 0; background:linear-gradient(90deg,transparent,#39ff14,transparent); filter:drop-shadow(0 0 4px #39ff14); }

    /* Animations for reveals */
    @keyframes fadeSlide { 0%{opacity:0; transform:translateY(16px);} 100%{opacity:1; transform:translateY(0);} }
    /* Quitar zoom: antes bounceIn escalaba; ahora solo desliza */
    /* @keyframes bounceIn { 0%{opacity:0; transform:translateY(30px) scale(.9);} 60%{opacity:1;} 80%{transform:translateY(-4px) scale(1.02);} 100%{transform:translateY(0) scale(1);} } */

    /* Footer */
    footer.site-footer {
      margin-top:60px; padding:30px 20px; background:#050b0d;
      border-top:3px solid #123b27; position:relative;
      box-shadow:0 -4px 20px #000000aa, 0 0 30px #39ff1411;
    }
    footer.site-footer::before {
      content:""; position:absolute; inset:0;
      background:
        radial-gradient(circle at 10% 80%, #39ff1415, transparent 60%),
        radial-gradient(circle at 90% 20%, #39ff1415, transparent 55%);
      pointer-events:none;
      animation:footerPulse 8s ease-in-out infinite;
    }
    @keyframes footerPulse { 0%,100%{opacity:.55;} 50%{opacity:.85;} }
    .footer-grid { display:grid; gap:24px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); }
    .footer-col h3 { font-size:14px; margin:0 0 10px; color:#39ff14; text-shadow:0 0 6px #39ff14; }
    .footer-col p, .footer-col a, .footer-col li { font-size:10px; color:#c9ffe4; text-decoration:none; line-height:1.5; }
    .disclaimer-box {
      background:#091712; border:2px solid #123b27; padding:14px 16px; border-radius:12px; font-size:9px;
      color:#9ef7c7; box-shadow:0 0 12px #39ff1422, inset 0 0 14px #0f2b1c;
    }
    .social-links a {
      display:inline-block; margin-right:8px; margin-bottom:6px; background:#0f2b1c; padding:6px 10px;
      border:2px solid #1e5a3c; border-radius:8px; font-size:9px; color:#a9ffcf;
      box-shadow:0 0 8px #39ff1433; transition:transform .15s, background .2s;
    }
    .social-links a:hover { transform:translateY(-3px); background:#143e2a; }
    .copyright { margin-top:28px; font-size:9px; text-align:center; color:#68ffb3; opacity:.8; }

    /* Utility classes */
    .fade-reveal { opacity:0; transform:translateY(18px); transition:opacity .7s ease, transform .7s ease; }
    .fade-reveal.visible { opacity:1; transform:translateY(0); }

    .defer-section { content-visibility:auto; contain-intrinsic-size:800px 600px; }

    @media (prefers-reduced-motion:reduce){
      *{ animation:none !important; transition:none !important; }
      .typewriter{ border-right:none !important; }
    }

    /* Typewriter */
    .typewriter { display:inline-block; border-right:2px solid #39ff14; white-space:nowrap; overflow:hidden; will-change:width; }
    .typewriter.caret-off { border-right-color:transparent; }

    /* Roadmap enhancements */
    .timeline-year {
      display:flex; align-items:center; gap:10px; margin:8px 0 6px; color:#9dfcc8; font-size:12px;
      text-shadow:0 0 6px #39ff1499;
    }
    .timeline-year .bar {
      height:2px; flex:1; background:linear-gradient(90deg,#39ff1400,#39ff14,#39ff1400);
      filter:drop-shadow(0 0 6px #39ff14);
    }
    .pixel-timeline { position:relative; padding-left:26px; }
    .pixel-timeline::before {
      content:""; position:absolute; left:8px; top:0; bottom:0; width:4px;
      background:linear-gradient(#07331f,#39ff14,#07331f);
      box-shadow:0 0 8px #39ff14aa; border-radius:4px;
    }
    .milestone {
      position:relative; margin:14px 0; padding:12px 12px 12px 14px;
      border:2px solid #1e5a3c; border-radius:12px; background:#0a1512;
      box-shadow:0 0 10px #39ff1422, inset 0 0 14px #0f2b1c;
      transform: translateY(10px); opacity:0;
      transition: transform .5s ease, opacity .5s ease, box-shadow .2s ease;
    }
    .milestone.reveal { transform: translateY(0); opacity:1; }
    .milestone:hover { box-shadow:0 0 18px #39ff14aa, inset 0 0 14px #0f2b1c; }
    .milestone::before {
      content:""; position:absolute; left:-19px; top:14px; width:14px; height:14px; border-radius:4px;
      background:#39ff14; border:2px solid #0f2b1c; box-shadow:0 0 10px #39ff14cc;
      /* quitar escala pulsante */
      animation:none;
    }
    .milestone-title { color:#a9ffcf; font-size:12px; margin:0 0 6px; display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
    .quarter-badge {
      font-size:10px; color:#052515; background:#39ff14; border:2px solid #0e3e28; border-radius:999px; padding:2px 8px;
      text-transform:uppercase; letter-spacing:.5px; box-shadow:0 0 8px #39ff1480;
    }

    /* Mobile header tuning */
    @media (max-width:640px){
      header .top-actions { width:100%; display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
      .nav-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; justify-content:flex-start; padding-bottom:4px; }
    }
  </style>
</head>
<body class="bg-gray-950 text-white min-h-screen">
  <div id="tsparticles" aria-hidden="true"></div>

  <div class="max-w-6xl mx-auto p-4 space-y-12">

    <!-- HEADER -->
    <header class="flex flex-col gap-4 py-4 border-b border-gray-800 fade-reveal" id="top">
      <div class="flex flex-col md:flex-row justify-between items-center gap-3">
        <h1 class="text-2xl sm:text-3xl font-bold text-green-400">Pepe Blackjack (PBJ)</h1>

        <!-- Acciones superiores: Connect + WalletConnect + Social -->
        <div class="top-actions">
          <a class="nav-btn" href="https://twitter.com/pepeblackjack21" target="_blank" rel="noopener" title="Twitter">
            <span>üê¶</span><span>Twitter</span>
          </a>
          <a class="nav-btn" href="https://t.me/pepeblackjack21" target="_blank" rel="noopener" title="Telegram">
            <span>‚úàÔ∏è</span><span>Telegram</span>
          </a>
          <button id="connectButton" class="nav-btn" style="font-size:11px;">Connect</button>
          <button id="wcButton" class="nav-btn" style="font-size:11px;" title="WalletConnect">WalletConnect</button>
        </div>

        <div id="pbjDisplay" style="display:none;align-items:center;gap:8px;font-size:14px;color:#39ff14;padding:6px 14px;border:2px solid #1e5a3c;border-radius:12px;background:#072818;box-shadow:0 0 8px #39ff1433;">
          <img src="./Coin.avif" alt="PBJ Coin" width="40" height="40" loading="lazy" decoding="async" style="image-rendering:pixelated;border-radius:50%;border:2px solid #1d5a3b;">
          <span id="pbjBalanceHeader">0</span> PBJ
        </div>
      </div>

      <nav class="nav-wrap">
        <a href="#presale" class="nav-btn">Presale</a>
        <a href="#nfts" class="nav-btn">NFTs</a>
        <a href="#staking" class="nav-btn">Staking</a>
        <a href="#blackjack" class="nav-btn">Blackjack</a>
        <a href="#lore" class="nav-btn">Lore</a>
        <a href="#roadmap" class="nav-btn">Roadmap</a>
        <a href="#tokenomics" class="nav-btn">Tokenomics</a>
        <a href="#team" class="nav-btn">Team</a>
        <a href="#faq" class="nav-btn">FAQ</a>
      </nav>
    </header>

    <div id="status" class="text-center text-base sm:text-lg fade-reveal" aria-live="polite"></div>

    <!-- HERO: PRESALE + BUY (with promo image on the right) -->
    <section id="presale" class="content-panel hero-grid fade-reveal">
      <!-- BUY PANEL -->
      <div class="pixel-panel" style="padding:24px;">
        <div class="panel-header" style="margin-bottom:14px; display:flex; align-items:center; gap:10px;">
          <img src="./Coin.avif" alt="PBJ Coin" class="coin" width="40" height="40" />
          <h2 style="color:#39ff14;font-size:18px;letter-spacing:1px;">Buy $PBJ (Presale)</h2>
        </div>

        <!-- Internal countdown + progress -->
        <div class="mini-box" id="heroCountdownBox">
          <div class="progress-rail">
            <div id="presale-progress" class="progress-bar"></div>
          </div>
          <div class="countdown-text" id="presale-countdown">Loading...</div>
          <div style="font-size:10px;color:#b1c9c0;text-align:center;margin-top:6px;">Presale time left (7 days)</div>
        </div>

        <div class="mini-box">
          <div class="progress-rail">
            <div id="eth-collected-progress" class="progress-bar" style="background:linear-gradient(90deg,#60a5ff,#2563eb);"></div>
          </div>
          <div class="collected-text" id="eth-collected-count">2 ETH collected of 20</div>
          <div style="font-size:10px;color:#b1c9c0;text-align:center;margin-top:6px;">Goal: 20 ETH</div>
        </div>

        <div class="mini-box">
          <div style="font-size:14px;color:#e8fdf2;margin-bottom:10px;line-height:1.4;">¬øQu√© opinas de la preventa?</div>
          <div class="vote-emojis" style="display:flex;gap:22px;justify-content:center;">
            <button class="emoji-vote-btn" data-emoji="üëç" aria-label="Vote üëç">üëç</button>
            <button class="emoji-vote-btn" data-emoji="üî•" aria-label="Vote üî•">üî•</button>
            <button class="emoji-vote-btn" data-emoji="ü§©" aria-label="Vote ü§©">ü§©</button>
            <button class="emoji-vote-btn" data-emoji="üíé" aria-label="Vote üíé">üíé</button>
            <button class="emoji-vote-btn" data-emoji="üòÇ" aria-label="Vote üòÇ">üòÇ</button>
          </div>
          <div id="vote-results" style="display:flex;gap:16px;justify-content:center;margin-top:14px;font-size:16px;color:#39ff14;"></div>
        </div>

        <!-- Rate / Balance -->
        <div class="panel-sub">
          <span>ETH Balance</span>
          <span id="ethBalance" class="font-mono text-white">0.0000 ETH</span>
        </div>
        <div class="rate-badge mb-2">
          <span>Rate</span>
          <span class="text-green-400 font-bold">1 ETH = 1,000,000 PBJ</span>
        </div>

        <!-- Quick Chips -->
        <div class="quick-row">
          <button class="quick-chip" data-eth="0.01">0.01</button>
          <button class="quick-chip" data-eth="0.05">0.05</button>
          <button class="quick-chip" data-eth="0.1">0.1</button>
          <button class="quick-chip" data-eth="0.25">0.25</button>
          <button class="quick-chip" data-eth="0.5">0.5</button>
          <button id="maxEthBtn" class="max-btn">MAX</button>
        </div>

        <!-- Form -->
        <div class="space-y-4 mb-4 form-presale">
          <div class="flex items-center space-x-2">
            <input type="number" id="ethAmount" min="0.01" step="0.0001" value="0.01"
              class="flex-1 bg-gray-800 border border-gray-700 rounded-lg px-3 py-3 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-green-400 text-sm"
              placeholder="0.0 ETH" />
            <span class="text-gray-300 font-medium text-sm">ETH</span>
          </div>
          <div class="flex justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
          <div class="flex items-center space-x-2">
            <input type="number" id="pbjAmount" min="10000" step="10000" value="10000"
              class="flex-1 bg-gray-800 border border-gray-700 rounded-lg px-3 py-3 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-green-400 text-sm"
              placeholder="0 PBJ" />
            <span class="text-gray-300 font-medium text-sm">PBJ</span>
          </div>
        </div>

        <button id="buyButton" disabled class="cta-btn">Buy</button>
        <div class="mini-sep"></div>
        <div class="mini-note">Conecta tu wallet para habilitar la compra ‚Ä¢ Base Network</div>
      </div>

      <!-- Right column: Promo image + info panels -->
      <div class="hero-subpanels">
        <!-- PROMO IMAGE -->
        <div class="hero-promo">
          <img src="./preventa.avif" alt="PBJ Presale Poster" width="896" height="448" decoding="async" loading="lazy" />
        </div>

        <div class="pixel-panel fade-reveal">
          <h3 style="color:#39ff14;font-size:14px;margin:0 0 12px;">¬øPor qu√© Base?</h3>
          <p style="font-size:11px;color:#b8ffda;line-height:1.6;">
            Comisiones ultra bajas, finalizaci√≥n r√°pida y un ecosistema en expansi√≥n permiten que PBJ escale un cripto casino multijuego.
            Tus tokens alimentan el juego, los NFTs amplifican recompensas y los jackpots entre juegos mantienen la adrenalina.
          </p>
        </div>
        <div class="pixel-panel fade-reveal">
          <h3 style="color:#39ff14;font-size:14px;margin:0 0 12px;">Mec√°nica de Preventa</h3>
          <ul style="font-size:11px;color:#c2ffe5;list-style:none;padding:0;margin:0;line-height:1.6;">
            <li>‚Ä¢ Tasa fija: 1 ETH = 1,000,000 PBJ</li>
            <li>‚Ä¢ Duraci√≥n: 7 d√≠as de cuenta regresiva</li>
            <li>‚Ä¢ Meta: 20 ETH</li>
            <li>‚Ä¢ Post-preventa: listado en DEX + staking</li>
          </ul>
        </div>
        <div class="pixel-panel fade-reveal">
          <h3 style="color:#39ff14;font-size:14px;margin:0 0 12px;">Sentimiento</h3>
          <p style="font-size:11px;color:#b8ffda;">Ayuda con reacciones arriba. Es social, no hay coste on-chain.</p>
        </div>
      </div>
    </section>

    <!-- NFTs -->
    <section id="nfts" class="content-panel fade-reveal">
      <h2 class="section-title">üé¥ PepeBlackjack NFTs <span class="neon-underline" aria-hidden="true"></span></h2>
      <div class="nft-section defer-section">
        <div class="nft-card">
          <div class="pixel-frame">
            <div class="nft-badge">üü¢ Com√∫n ‚Ä¢ 5,000 PBJ</div>
            <div class="nft-image-wrap">
              <img src="nft1.avif" alt="Common NFT" width="250" height="250" loading="lazy" decoding="async">
              <div class="price-tag">5,000 PBJ</div>
            </div>
            <h2>üü¢ Common</h2>
            <p>Reward: 200 PBJ / d√≠a</p>
            <button class="pixel-button mt-3" onclick="buyNFT(0)">Comprar üü¢ Common</button>
          </div>
        </div>
        <div class="nft-card">
          <div class="pixel-frame">
            <div class="nft-badge">üîµ Raro ‚Ä¢ 10,000 PBJ</div>
            <div class="nft-image-wrap">
              <img src="nft2.avif" alt="Rare NFT" width="250" height="250" loading="lazy" decoding="async">
              <div class="price-tag">10,000 PBJ</div>
            </div>
            <h2>üîµ Rare</h2>
            <p>Reward: 500 PBJ / d√≠a</p>
            <button class="pixel-button mt-3" onclick="buyNFT(1)">Comprar üîµ Rare</button>
          </div>
        </div>
        <div class="nft-card">
          <div class="pixel-frame">
            <div class="nft-badge">üü£ Legendario ‚Ä¢ 25,000 PBJ</div>
            <div class="nft-image-wrap">
              <img src="nft3.avif" alt="Legendary NFT" width="250" height="250" loading="lazy" decoding="async">
              <div class="price-tag">25,000 PBJ</div>
            </div>
            <h2>üü£ Legendary</h2>
            <p>Reward: 1,500 PBJ / d√≠a</p>
            <button class="pixel-button mt-3" onclick="buyNFT(2)">Comprar üü£ Legendary</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Your NFTs -->
    <section id="nftSection" class="content-panel defer-section fade-reveal" style="text-align:center;">
      <h2 class="section-title">üßæ Tus NFTs <span class="neon-underline" aria-hidden="true"></span></h2>
      <div id="userNFTs" style="display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px;"></div>
    </section>

    <!-- Staking -->
    <section id="staking" class="content-panel defer-section fade-reveal">
      <h2 class="section-title">ü™ô NFT Staking <span class="neon-underline" aria-hidden="true"></span></h2>
      <div>
        <h3 class="text-green-400 font-semibold mb-2" style="font-size:12px;">Tus NFTs disponibles</h3>
        <div id="userNFTsStake" class="flex gap-6 overflow-x-auto py-2"></div>
      </div>
      <div class="mt-8">
        <h3 class="text-green-400 font-semibold mb-2" style="font-size:12px;">Tus NFTs en staking</h3>
        <div id="stakedNFTs" class="flex gap-6 overflow-x-auto py-2"></div>
      </div>
    </section>

    <!-- Blackjack -->
    <section id="blackjack" class="content-panel defer-section fade-reveal">
      <h2 class="section-title">üÉè PBJ Blackjack (On-Chain) <span class="neon-underline" aria-hidden="true"></span></h2>
      <div class="blackjack-wrapper">
        <div class="floating-glow"></div>
        <div class="bet-panel">
          <label for="betAmountPBJ">Apuesta (PBJ tokens):</label>
          <input id="betAmountPBJ" type="number" min="10" step="10" value="1000" placeholder="PBJ amount" />
          <div class="bet-status" id="betStatus"></div>
          <div class="score-badge" id="pbjBalanceGameWrap">
            <span class="chip"></span>
            Balance: <span id="pbjBalanceGame">0</span> PBJ
          </div>
        </div>
        <div class="divider-line"></div>
        <div class="flex items-center justify-between mb-2 px-2">
          <div class="score-badge">Dealer <span id="dealerScore">0</span></div>
          <div class="score-badge" style="background:#091d13;border-color:#206246;color:#9fdcb8;">Estado: <span id="gameState">Idle</span></div>
        </div>
        <!-- Cartas pre-servidas para identificar la zona -->
        <div id="dealerArea" class="hand-row" aria-label="Dealer cards">
          <div class="card back reveal" style="transform:translateY(0) rotate(-4deg)"></div>
          <div class="card back reveal" style="transform:translateY(0) rotate(4deg)"></div>
        </div>
        <div class="divider-line"></div>
        <div class="flex items-center justify-between mb-2 px-2">
          <div class="score-badge">Player <span id="playerScore">0</span></div>
          <div class="score-badge" style="background:#072818;">Apuesta Activa: <span id="activeBetDisplay">0</span> PBJ</div>
        </div>
        <div id="playerArea" class="hand-row" aria-label="Player cards">
          <div class="card back reveal" style="transform:translateY(0) rotate(-6deg)"></div>
          <div class="card back reveal" style="transform:translateY(0) rotate(2deg)"></div>
          <div class="card back reveal" style="transform:translateY(0) rotate(8deg)"></div>
        </div>
        <div class="btn-grid">
          <button id="dealBtn" class="bj-btn">DEAL</button>
          <button id="hitBtn" class="bj-btn secondary" disabled>HIT</button>
          <button id="standBtn" class="bj-btn secondary" disabled>STAND</button>
          <button id="doubleBtn" class="bj-btn secondary" disabled>DOUBLE</button>
          <button id="cancelBtn" class="bj-btn cancel" disabled>CANCEL BET</button>
        </div>
        <div id="resultMsg" class="result-banner"></div>
      </div>
    </section>

    <!-- Lore -->
    <section id="lore" class="content-panel defer-section flex flex-col md:flex-row items-center gap-6 scanline fade-reveal">
      <div class="w-full md:w-1/3">
        <img src="./carta.avif" alt="PBJ Card Art" class="w-full h-auto rounded-lg border-2 border-green-800 shadow-inner" loading="lazy" decoding="async" width="800" height="600" />
      </div>
      <div class="w-full md:w-2/3">
        <h2 class="section-title">üìñ Lore <span class="neon-underline" aria-hidden="true"></span></h2>
        <p class="text-gray-300 leading-relaxed" id="loreIntro">
          En el cripto casino de la red Base, Pepe reparte cartas con un objetivo claro:
          ser el mejor casino cripto en Base... y luego el mejor a nivel global.
        </p>
        <p class="text-gray-300 leading-relaxed" id="loreBody" style="margin-top:10px;">
          PBJ fusiona energ√≠a meme, juego responsable y tecnolog√≠a de alto rendimiento. Base ofrece bajas comisiones y
          finalizaci√≥n r√°pida para un gameplay justo y √°gil: blackjack, slots, dice, crash, plinko, ruleta,
          poker y m√°s en camino. Los NFTs amplifican rendimientos y los jackpots conectados encienden la acci√≥n.
        </p>
        <p class="text-green-400 leading-relaxed" style="margin-top:12px;">
          Visi√≥n: <span id="loreType" class="typewriter" aria-live="polite"></span>
        </p>
      </div>
    </section>

    <!-- Roadmap -->
    <section id="roadmap" class="content-panel defer-section fade-reveal">
      <h2 class="section-title">üó∫Ô∏è Roadmap <span class="neon-underline" aria-hidden="true"></span></h2>
      <div class="flex flex-col md:flex-row items-start gap-6">
        <div class="w-full md:w-1/3">
          <img src="./logo.avif" alt="PBJ Logo" class="w-full h-auto rounded-lg border-2 border-green-800 shadow-inner" loading="lazy" decoding="async" width="512" height="512" />
        </div>
        <div class="w-full md:w-2/3">
          <div class="timeline-year"><span>2025</span><span class="bar"></span></div>
          <div class="pixel-timeline">
            <div class="milestone">
              <div class="milestone-title"><span class="quarter-badge">Q2 2025</span> üöÄ Base Launch</div>
              <p class="milestone-desc">PBJ presale, contract deployment, Blackjack MVP, security focus & initial audits.</p>
            </div>
            <div class="milestone">
              <div class="milestone-title"><span class="quarter-badge">Q3 2025</span> üß™ On-Chain Economies</div>
              <p class="milestone-desc">DEX listing, PBJ staking, utility NFTs, rakeback, leaderboards & weekly challenges.</p>
            </div>
            <div class="milestone">
              <div class="milestone-title"><span class="quarter-badge">Q4 2025</span> üé∞ Base Arcade</div>
              <p class="milestone-desc">Crash, Dice, Plinko, Slots & Roulette. Provably-fair engine, mobile PWA & gamer profiles.</p>
            </div>
          </div>

          <div class="timeline-year" style="margin-top:18px;"><span>2026</span><span class="bar"></span></div>
          <div class="pixel-timeline">
            <div class="milestone">
              <div class="milestone-title"><span class="quarter-badge">Q1 2026</span> üèÜ Global Jackpots</div>
              <p class="milestone-desc">Cross‚Äëgame jackpots, missions, NFT achievements, affiliate program & multilingual rollout.</p>
            </div>
            <div class="milestone">
              <div class="milestone-title"><span class="quarter-badge">Q2 2026</span> üåé Path to #1</div>
              <p class="milestone-desc">Alliances, international tournaments, regional compliance expansion & brand dominance.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tokenomics -->
    <section id="tokenomics" class="content-panel defer-section flex flex-col md:flex-row items-start gap-8 fade-reveal">
      <div class="w-full md:w-1/2">
        <h2 class="section-title">üìä Tokenomics <span class="neon-underline" aria-hidden="true"></span></h2>
        <div id="tokenomics-bars" class="space-y-3"></div>
        <div class="mt-6 bg-gray-800 rounded-lg p-4 text-xs space-y-1 border border-green-900">
          <div><span class="text-green-400">Symbol:</span> PBJ</div>
          <div><span class="text-green-400">Network:</span> Base</div>
          <div><span class="text-green-400">Total Supply:</span> 1,000,000,000 PBJ</div>
          <div><span class="text-green-400">Presale Price:</span> 1 ETH = 1,000,000 PBJ</div>
          <div><span class="text-green-400">Contract:</span>
            <a href="https://basescan.org/address/0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5" class="text-blue-400 underline" target="_blank" rel="noopener">0xff4b4f2076F3...06B944E5</a>
          </div>
        </div>
      </div>
      <div class="w-full md:w-1/2 flex flex-col items-center gap-4">
        <div class="pizza-box w-full max-w-xs sm:max-w-sm">
          <div class="pizza-lid text-center">
            <div class="font-bold text-yellow-300 text-lg">$PBJ UTILITY</div>
          </div>
        </div>
        <div id="tokenomics-legend" class="grid grid-cols-1 gap-2 w-full"></div>
        <ul class="bg-gray-800 w-full rounded-lg p-4 space-y-2 text-xs border border-green-900">
          <li>Staking ‚Äì automatic reward pool distribution.</li>
          <li>Blackjack ‚Äì game rewards, rakeback & themed jackpots.</li>
          <li>Community ‚Äì tournaments, contests & leaderboards.</li>
          <li>Alliances ‚Äì integrations & gamified events.</li>
        </ul>
      </div>
    </section>

    <!-- Team -->
    <section id="team" class="content-panel defer-section fade-reveal">
      <h2 class="section-title">üë• Team & Links <span class="neon-underline" aria-hidden="true"></span></h2>
      <ul class="text-gray-300 space-y-2 text-xs">
        <li><strong>Team:</strong> Vortex (Dev), John Smith (Marketing), CryptoFrogDAO (Community)</li>
        <li><strong>Website:</strong> <a href="#" class="text-blue-400 underline">www.pepeblackjack.online</a></li>
        <li><strong>Twitter:</strong> <a href="https://twitter.com/pepeblackjack21" class="text-blue-400 underline" rel="noopener" target="_blank">@pepeblackjack21</a></li>
        <li><strong>Telegram:</strong> <a href="https://t.me/pepeblackjack21" class="text-blue-400 underline" rel="noopener" target="_blank">@pepeblackjack21</a></li>
      </ul>
    </section>

    <!-- FAQ -->
    <section id="faq" class="content-panel defer-section fade-reveal">
      <h2 class="section-title">‚ùì FAQ <span class="neon-underline" aria-hidden="true"></span></h2>
      <div class="text-gray-300 space-y-4 text-xs">
        <div>
          <h3 class="font-semibold" style="font-size:12px;">¬øC√≥mo compro PBJ?</h3>
          <p>Conecta tu wallet (MetaMask / WalletConnect), establece la cantidad de ETH o PBJ y presiona "Buy".</p>
        </div>
        <div>
          <h3 class="font-semibold" style="font-size:12px;">¬øQu√© pasa cuando termina la preventa?</h3>
          <p><code>endPresale()</code> detiene compras; los tokens se listan en DEX y se habilita staking y utilidades del casino.</p>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer id="footer" class="site-footer fade-reveal">
      <div class="footer-grid">
        <div class="footer-col">
          <h3>Navigation</h3>
          <p><a href="#top">Top</a><br><a href="#presale">Presale</a><br><a href="#nfts">NFTs</a><br><a href="#blackjack">Blackjack</a></p>
        </div>
        <div class="footer-col">
          <h3>Social</h3>
          <div class="social-links">
            <a href="https://twitter.com/pepeblackjack21" target="_blank" rel="noopener">Twitter</a>
            <a href="https://t.me/pepeblackjack21" target="_blank" rel="noopener">Telegram</a>
          </div>
        </div>
        <div class="footer-col">
          <h3>Disclaimer</h3>
          <div class="disclaimer-box">
            This project is experimental and DOES NOT constitute financial, legal or tax advice.
            Using the DApp involves risk of total fund loss. Do your own research.
            The team does not guarantee profits, token price stability, or service continuity.
            By interacting you accept full responsibility for your actions.
          </div>
        </div>
        <div class="footer-col">
          <h3>Contract</h3>
          <p><a href="https://basescan.org/address/0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5" target="_blank" rel="noopener">BaseScan</a></p>
          <p style="margin-top:6px;">1 ETH = 1,000,000 PBJ (Presale)</p>
        </div>
      </div>
      <div class="copyright">
        ¬© 2025 Pepe Blackjack (PBJ). All rights reserved. Use at your own risk.
      </div>
    </footer>
  </div>

  <!-- PARTICLES -->
  <script defer>
    function initParticles() {
      if (typeof tsParticles === 'undefined') return;
      tsParticles.load("tsparticles", {
        background:{ color:{ value:"#000" } },
        fpsLimit:60,
        interactivity:{
          events:{ onHover:{ enable:true, mode:"repulse" }, resize:true },
          modes:{ repulse:{ distance:100, duration:0.4 } }
        },
        particles:{
          color:{ value:"#00ff99" },
          links:{ enable:true, color:"#00ff99", distance:150 },
          move:{ enable:true, speed:2 },
          number:{ value:window.matchMedia('(max-width:600px)').matches ? 25 : 45 },
          opacity:{ value:0.45 },
          shape:{ type:"circle" },
          size:{ value:{ min:1, max:2 } }
        },
        detectRetina:true
      });
    }
    window.addEventListener('load', () => {
      if ('requestIdleCallback' in window) requestIdleCallback(initParticles, { timeout:1200 });
      else setTimeout(initParticles, 500);
    });
  </script>

  <!-- APP LOGIC (recortado a lo esencial para los cambios pedidos) -->
  <script defer>
    /* ================== Config ================== */
    let provider, signer, userAddress;
    let pbjContract, casinoContract, presaleContract;

    const rate = 1000000;
    const PRESALE_DURATION_MS = 7 * 24 * 60 * 60 * 1000;
    const presaleStart = Date.now();

    const contractAddress     = '0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5';
    const pbjContractAddress  = '0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5';
    const pbjTokenAddress     = '0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5';
    const casinoAddress       = '0x79e617b64eae98bda7f8Cd4b1EdC05dE696E4B74';
    const nftAddress          = '0x4AabC024D719240e98e82930EAC04bD49CB86E31';

    const pbjAbi = [
      'function balanceOf(address) view returns (uint256)',
      'function decimals() view returns (uint8)',
      'function approve(address spender, uint256 amount) returns (bool)',
      'function allowance(address owner, address spender) view returns (uint256)'
    ];
    const casinoAbi = [
      'function placeBet(uint256 amount) external',
      'function finishGame(bool playerWon) external',
      'function cancelBet() external'
    ];
    const presaleAbi = ['function buyTokens() payable'];
    const nftAbi = [
      {"inputs":[{"internalType":"enum PepeBlackjackNFT.Rarity","name":"_rarity","type":"uint8"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"},
      {"inputs":[],"name":"pbjToken","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},
      {"inputs":[{"internalType":"enum PepeBlackjackNFT.Rarity","name":"","type":"uint8"}],"name":"nftTypes","outputs":[
        {"internalType":"uint256","name":"pricePBJ","type":"uint256"},
        {"internalType":"uint256","name":"totalSupply","type":"uint256"},
        {"internalType":"uint256","name":"minted","type":"uint256"}
      ],"stateMutability":"view","type":"function"}
    ];

    const isMobile = () => /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    function showStatus(msg, ok = true) {
      const el = document.getElementById('status');
      if (!el) return;
      el.textContent = msg;
      el.style.color = ok ? '#39ff14' : '#ff5151';
    }

    async function ensureBaseNetwork() {
      try {
        const net = await provider.getNetwork();
        if (net.chainId === 8453) return true;
        if (provider.provider && provider.provider.request) {
          try {
            await provider.provider.request({ method:'wallet_switchethereumchain', params:[{ chainId:'0x2105' }] });
            return true;
          } catch(e){
            try {
              await provider.provider.request({
                method:'wallet_addEthereumChain',
                params:[{
                  chainId:'0x2105',
                  chainName:'Base',
                  nativeCurrency:{ name:'Ether', symbol:'ETH', decimals:18 },
                  rpcUrls:['https://mainnet.base.org'],
                  blockExplorerUrls:['https://basescan.org']
                }]
              });
              return true;
            } catch(e2){
              showStatus('Cambia a Base (8453).', false);
              return false;
            }
          }
        }
        return false;
      } catch(e){ return false; }
    }

    function bindProviderEvents(eip1193Provider){
      if(!eip1193Provider?.on) return;
      eip1193Provider.on('accountsChanged', async (acc)=>{
        if(acc.length){
          userAddress = acc[0];
          await afterConnected();
        } else {
          showStatus('Wallet desconectada', false);
        }
      });
      eip1193Provider.on('chainChanged', async ()=>{
        await ensureBaseNetwork();
        await afterConnected();
      });
      eip1193Provider.on('disconnect', ()=> showStatus('Wallet desconectada', false));
    }

    async function connectInjected(){
      if(!window.ethereum) return null;
      await window.ethereum.request({ method:'eth_requestAccounts' });
      const ethProvider = new ethers.providers.Web3Provider(window.ethereum, 'any');
      bindProviderEvents(window.ethereum);
      return ethProvider;
    }

    async function connectWalletConnect(){
      try {
        const { default: EthereumProvider } = await import("https://esm.sh/@walletconnect/ethereum-provider@2.11.1");
        const projectId = "06606e3b978574fe1fe67024c91c5aa3";
        const wcProvider = await EthereumProvider.init({
          projectId,
          chains:[8453],
          showQrModal:true,
          optionalChains:[8453],
          methods:["eth_sendTransaction","personal_sign","eth_sign","eth_signTypedData","eth_signTransaction"],
          events:["chainChanged","accountsChanged"],
          rpcMap:{8453:"https://mainnet.base.org"},
          metadata:{
            name:"Pepe Blackjack (PBJ)",
            description:"PBJ Presale + Blackjack",
            url:window.location.origin,
            icons:[window.location.origin + "/logo.avif"]
          }
        });
        await wcProvider.enable();
        const ethProvider = new ethers.providers.Web3Provider(wcProvider, 'any');
        bindProviderEvents(wcProvider);
        return ethProvider;
      } catch (e) {
        showStatus('Error al conectar con WalletConnect', false);
        return null;
      }
    }

    async function afterConnected(){
      try{
        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        document.getElementById('buyButton').disabled = false;
        document.getElementById('pbjDisplay').style.display = 'inline-flex';

        // ETH balance
        const bal = await provider.getBalance(userAddress);
        document.getElementById('ethBalance').textContent = `${ethers.utils.formatEther(bal)} ETH`;

        // PBJ balance
        pbjContract = new ethers.Contract(pbjTokenAddress, pbjAbi, signer);
        const pbjBal = await pbjContract.balanceOf(userAddress);
        const decimals = 18;
        const disp = ethers.utils.formatUnits(pbjBal, decimals);
        document.getElementById('pbjBalanceHeader').textContent = (+disp).toLocaleString();
        document.getElementById('pbjBalanceGame').textContent = (+disp).toLocaleString();
      }catch(e){
        // noop
      }
    }

    function wireBuyCalculator(){
      const ethInput = document.getElementById('ethAmount');
      const pbjInput = document.getElementById('pbjAmount');

      function syncFromEth(){
        const eth = parseFloat(ethInput.value || '0');
        const pbj = isNaN(eth) ? 0 : eth * rate;
        pbjInput.value = Math.floor(pbj);
      }
      function syncFromPBJ(){
        const pbj = parseFloat(pbjInput.value || '0');
        const eth = isNaN(pbj) ? 0 : pbj / rate;
        ethInput.value = eth.toFixed(4);
      }

      ethInput.addEventListener('input', syncFromEth);
      pbjInput.addEventListener('input', syncFromPBJ);

      document.querySelectorAll('.quick-chip').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          ethInput.value = btn.dataset.eth;
          syncFromEth();
        });
      });
      document.getElementById('maxEthBtn').addEventListener('click', async ()=>{
        if(!provider || !signer) return;
        const bal = await provider.getBalance(await signer.getAddress());
        const eth = Number(ethers.utils.formatEther(bal)) * 0.98;
        ethInput.value = eth.toFixed(4);
        syncFromEth();
      });
    }

    function startCountdown(){
      const elC = document.getElementById('presale-countdown');
      const elP = document.getElementById('presale-progress');
      const goalMs = PRESALE_DURATION_MS;

      function tick(){
        const elapsed = Date.now() - presaleStart;
        const left = Math.max(0, goalMs - elapsed);
        const d = Math.floor(left / (24*3600e3));
        const h = Math.floor((left % (24*3600e3)) / 3600e3);
        const m = Math.floor((left % 3600e3) / 60e3);
        const s = Math.floor((left % 60e3) / 1000);
        elC.textContent = `${d}d ${h}h ${m}m ${s}s`;
        elP.style.width = `${Math.min(100, (elapsed/goalMs)*100)}%`;
      }
      tick();
      setInterval(tick, 1000);
    }

    async function buyNFT(index){
      try{
        if(!signer) { showStatus('Conecta tu wallet', false); return; }
        const nft = new ethers.Contract(nftAddress, nftAbi, signer);
        await (await nft.mint(index)).wait();
        showStatus('NFT comprado con √©xito');
      }catch(e){ showStatus('Error comprando NFT', false); }
    }
    window.buyNFT = buyNFT;

    async function handleBuy(){
      try{
        if(!signer){ showStatus('Conecta tu wallet', false); return; }
        const eth = document.getElementById('ethAmount').value;
        const tx = { to: contractAddress, value: ethers.utils.parseEther(String(eth)) };
        await (await signer.sendTransaction(tx)).wait();
        showStatus('Compra realizada con √©xito');
      }catch(e){ showStatus('Error en la compra', false); }
    }

    function seedBlackjackPlaceholders(){
      // Ya est√°n en el HTML; este m√©todo asegura que se repongan si se borran sin jugar
      const dealer = document.getElementById('dealerArea');
      const player = document.getElementById('playerArea');
      if(dealer && dealer.children.length === 0){
        ['-4deg','4deg'].forEach(rot=>{
          const c = document.createElement('div');
          c.className = 'card back reveal';
          c.style.transform = `translateY(0) rotate(${rot})`;
          dealer.appendChild(c);
        });
      }
      if(player && player.children.length === 0){
        ['-6deg','2deg','8deg'].forEach(rot=>{
          const c = document.createElement('div');
          c.className = 'card back reveal';
          c.style.transform = `translateY(0) rotate(${rot})`;
          player.appendChild(c);
        });
      }
    }

    function clearBlackjackPlaceholders(){
      const dealer = document.getElementById('dealerArea');
      const player = document.getElementById('playerArea');
      if(dealer) dealer.innerHTML = '';
      if(player) player.innerHTML = '';
    }

    function wireBlackjackButtons(){
      document.getElementById('dealBtn')?.addEventListener('click', ()=>{
        // Limpiar cartas de placeholder al iniciar
        clearBlackjackPlaceholders();
        document.getElementById('gameState').textContent = 'Dealing...';
        // El juego real deber√° repartir aqu√≠ (esta l√≥gica queda en tu script original)
      });
    }

    function wireConnectButtons(){
      document.getElementById('connectButton')?.addEventListener('click', async ()=>{
        provider = await connectInjected();
        if(provider){
          const ok = await ensureBaseNetwork();
          if(ok) afterConnected();
        } else {
          showStatus('Instala una wallet compatible con Ethereum', false);
        }
      });
      document.getElementById('wcButton')?.addEventListener('click', async ()=>{
        provider = await connectWalletConnect();
        if(provider){
          const ok = await ensureBaseNetwork();
          if(ok) afterConnected();
        }
      });
      document.getElementById('buyButton')?.addEventListener('click', handleBuy);
    }

    function wireVotes(){
      const res = document.getElementById('vote-results');
      const counts = {};
      document.querySelectorAll('.emoji-vote-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const e = btn.dataset.emoji;
          counts[e] = (counts[e]||0)+1;
          res.innerHTML = Object.entries(counts).map(([k,v])=>`${k} ${v}`).join(' ‚Ä¢ ');
        });
      });
    }

    function revealOnScroll(){
      const els = document.querySelectorAll('.fade-reveal');
      const onScroll = ()=>{
        els.forEach(el=>{
          const rect = el.getBoundingClientRect();
          if(rect.top < window.innerHeight - 60) el.classList.add('visible');
        });
      };
      onScroll();
      window.addEventListener('scroll', onScroll, { passive:true });
    }

    function typewriter(el, text, speed=40){
      if(!el) return;
      let i=0;
      const tick = ()=>{
        el.textContent = text.slice(0, i++);
        if(i<=text.length) setTimeout(tick, speed);
        else el.classList.add('caret-off');
      };
      tick();
    }

    window.addEventListener('DOMContentLoaded', ()=>{
      wireConnectButtons();
      wireBuyCalculator();
      startCountdown();
      wireVotes();
      wireBlackjackButtons();
      revealOnScroll();
      seedBlackjackPlaceholders();
      typewriter(document.getElementById('loreType'), 'Ser el casino cripto N¬∫1 en Base con juegos justos, r√°pidos y divertidos.');
    });

    // Accesibilidad: volver a sembrar placeholders si el usuario navega sin jugar
    document.addEventListener('visibilitychange', ()=>{
      if(document.visibilityState === 'visible'){
        seedBlackjackPlaceholders();
      }
    });
  </script>
</body>
</html>
