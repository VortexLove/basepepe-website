<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
  <title>Pepe Blackjack (PBJ) - Premier Crypto Casino</title>
  <meta name="description" content="The #1 Meme Casino on Base. Play Blackjack, Slots, Plinko. Stake NFTs." />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Press+Start+2P&display=swap" rel="stylesheet" />

  <!-- CSS Frameworks -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Web3 Essentials -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    :root {
      --neon-green: #39ff14;
      --panel-bg: rgba(8, 12, 10, 0.92);
      --glass-border: rgba(57, 255, 20, 0.25);
    }

    /* Typography */
    h1, h2, h3, .nav-btn, .pixel-font { font-family: 'Press Start 2P', cursive; }
    body { font-family: 'Inter', sans-serif; background-color: #020202; color: #e0e0e0; overflow-x: hidden; }

    /* Backgrounds */
    body::before {
      content: ""; position: fixed; inset: 0; pointer-events: none; z-index: -2;
      background: radial-gradient(circle at 20% 50%, rgba(34, 197, 94, 0.08), transparent 40%),
                  radial-gradient(circle at 80% 20%, rgba(37, 99, 235, 0.08), transparent 40%);
    }
    body::after {
      content: ""; position: fixed; inset: 0; pointer-events: none; z-index: -2;
      background-image: linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
      background-size: 40px 40px;
    }

    /* Glass Panels */
    .glass-panel {
      background: var(--panel-bg);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7);
      transition: transform 0.3s ease, border-color 0.3s ease;
    }
    .glass-panel:hover {
      border-color: rgba(57, 255, 20, 0.6);
    }

    /* Blackjack Table Visuals */
    .table-felt {
      position: relative;
      background-color: #0e5c2f;
      background-image: radial-gradient(circle at 50% 50%, #137a3f 0%, #0b4624 100%);
      border: 12px solid #3d2314; /* Wood border */
      border-radius: 40px 40px 150px 150px; /* Semi-circle shape */
      box-shadow: inset 0 0 80px rgba(0,0,0,0.6), 0 20px 60px rgba(0,0,0,0.8);
      padding: 2rem;
    }
    .table-felt::before {
      content: "PEPE CASINO";
      position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%);
      font-family: 'Press Start 2P'; color: rgba(0,0,0,0.15); font-size: 2rem; pointer-events: none; text-align: center;
      width: 100%;
    }
    .table-line {
      position: absolute; bottom: 30%; left: 10%; right: 10%; height: 2px;
      background: rgba(255,255,255,0.1); border-radius: 50%;
    }

    /* Buttons */
    .nav-btn { font-size: 10px; text-transform: uppercase; letter-spacing: 1px; transition: all 0.2s; cursor: pointer; }
    .nav-btn:hover { color: var(--neon-green); text-shadow: 0 0 8px var(--neon-green); transform: translateY(-2px); }
    
    .action-btn {
      background: linear-gradient(135deg, #22c55e 0%, #166534 100%);
      box-shadow: 0 4px 0 #064e3b; transition: all 0.1s; text-shadow: 1px 1px 0 #000;
    }
    .action-btn:active { transform: translateY(4px); box-shadow: 0 0 0 transparent; }
    .action-btn:disabled { background: #333; box-shadow: none; cursor: not-allowed; opacity: 0.6; filter: grayscale(1); }

    /* Game Cards */
    .game-card {
      position: relative; overflow: hidden; border-radius: 12px; cursor: pointer;
      border: 1px solid #222; transition: all 0.3s; display: block;
    }
    .game-card:hover { transform: translateY(-5px); border-color: var(--neon-green); box-shadow: 0 0 15px rgba(57, 255, 20, 0.2); }
    .game-card img { width: 100%; height: 160px; object-fit: cover; transition: transform 0.3s; }
    .game-card:hover img { transform: scale(1.05); }
    .play-overlay {
      position: absolute; inset: 0; background: rgba(0,0,0,0.7);
      display: flex; align-items: center; justify-content: center;
      opacity: 0; transition: opacity 0.2s;
    }
    .game-card:hover .play-overlay { opacity: 1; }

    /* Cards (Playing Cards) */
    .card {
      width: 70px; height: 100px; background: white; border-radius: 6px;
      position: relative; display: flex; align-items: center; justify-content: center;
      font-family: 'Inter', sans-serif; font-weight: bold; font-size: 20px;
      box-shadow: 2px 4px 10px rgba(0,0,0,0.4);
      transform: translateY(-30px) scale(0.8); opacity: 0;
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.4s;
    }
    .card.reveal { transform: translateY(0) scale(1); opacity: 1; }
    .card.red { color: #ef4444; } .card.black { color: #171717; }
    .card .corner-val { position: absolute; font-size: 10px; line-height: 1; }
    .card .tl { top: 4px; left: 4px; }
    .card .br { bottom: 4px; right: 4px; transform: rotate(180deg); }
    @media(min-width: 640px){ .card { width: 90px; height: 130px; font-size: 28px; } }

    /* Toasts */
    #toast-container { position: fixed; bottom: 20px; right: 20px; left: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; pointer-events: none; }
    .toast {
      background: rgba(10, 10, 10, 0.95); border-left: 4px solid var(--neon-green);
      color: white; padding: 12px 20px; border-radius: 4px; font-size: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5); animation: slideIn 0.3s forwards;
      pointer-events: auto; max-width: 100%;
    }
    .toast.error { border-left-color: #ef4444; }
    @keyframes slideIn { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* Pie Chart */
    .pie-chart {
      width: 180px; height: 180px; border-radius: 50%;
      background: conic-gradient(#22c55e 0% 40%, #3b82f6 40% 65%, #a855f7 65% 85%, #f59e0b 85% 95%, #ef4444 95% 100%);
      position: relative; box-shadow: 0 0 20px rgba(34, 197, 94, 0.1);
    }
    .pie-chart::after {
      content: "1B"; position: absolute; inset: 25%; background: #020202; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; font-size: 14px; color: white; font-weight: bold;
    }
  </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

  <div id="toast-container"></div>

  <!-- HEADER -->
  <nav class="sticky top-0 z-50 bg-black/90 backdrop-blur-md border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-3 flex flex-wrap items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 bg-green-500 rounded-full shadow-[0_0_15px_#22c55e]"></div>
        <span class="text-green-400 text-sm md:text-lg pixel-font">PBJ CASINO</span>
      </div>
      
      <div class="hidden lg:flex gap-6">
        <a href="#games" class="nav-btn text-gray-400">Lobby</a>
        <a href="#blackjack" class="nav-btn text-gray-400">Blackjack</a>
        <a href="#staking" class="nav-btn text-gray-400">Staking</a>
        <a href="#presale" class="nav-btn text-gray-400">Buy PBJ</a>
      </div>

      <div class="flex items-center gap-3 ml-auto md:ml-0">
        <div id="walletDisplay" class="hidden items-center gap-2 px-3 py-1 rounded-full border border-green-800 bg-green-900/20 text-[10px] md:text-xs text-green-400">
          <span id="pbjBalanceHeader">0</span> PBJ
        </div>
        <button id="connectBtn" class="pixel-font bg-green-600 hover:bg-green-500 text-black text-[10px] px-4 py-2 rounded shadow-[0_0_10px_rgba(34,197,94,0.4)] transition-all">
          CONNECT
        </button>
      </div>
    </div>
    
    <!-- LIVE STATS BAR -->
    <div class="bg-green-900/20 border-b border-green-500/10 py-1">
      <div class="max-w-7xl mx-auto px-4 flex justify-between items-center text-[10px] font-mono">
        <div class="flex items-center gap-2 text-green-400">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
          </span>
          <span id="online-count">1,243</span> Online
        </div>
        <div id="winner-ticker" class="text-gray-400">Waiting for latest wins...</div>
      </div>
    </div>
  </nav>

  <main class="flex-grow max-w-6xl mx-auto w-full px-4 py-8 space-y-20">

    <!-- HERO & BUY SECTION (PRESALE) -->
    <section id="presale" class="grid md:grid-cols-2 gap-12 items-center pt-4">
      <div class="space-y-6 text-center md:text-left">
        <div class="inline-block px-3 py-1 rounded-full border border-green-500/30 bg-green-500/10 text-green-400 text-[10px] font-bold tracking-widest mb-2">
          OFFICIAL PRESALE
        </div>
        <h1 class="text-3xl md:text-5xl leading-tight text-white">
          Get <span class="text-green-500">PBJ</span> Tokens
        </h1>
        <p class="text-gray-400 leading-relaxed text-xs md:text-sm">
          The fuel for the entire Pepe Blackjack ecosystem. Buy now at fixed presale rate.
        </p>

        <!-- Swap UI -->
        <div class="glass-panel p-6 space-y-4 relative overflow-hidden max-w-md mx-auto md:mx-0">
          <div class="flex justify-between text-xs text-gray-400 mb-1">
            <span>Pay with ETH</span>
            <span>Balance: <span id="ethBalance" class="text-white">0.0000</span></span>
          </div>
          
          <div class="bg-black/60 rounded-xl p-3 border border-gray-700 flex items-center gap-2">
            <input type="number" id="ethInput" class="bg-transparent text-white text-lg w-full outline-none font-mono" placeholder="0.0">
            <button id="maxBtn" class="text-[10px] bg-gray-700 px-2 py-1 rounded text-green-400 hover:bg-gray-600 transition">MAX</button>
            <span class="font-bold text-gray-300 text-sm">ETH</span>
          </div>

          <div class="flex justify-center -my-2 relative z-10">
             <div class="bg-gray-800 rounded-full p-1 border border-gray-600">‚¨áÔ∏è</div>
          </div>

          <div class="flex justify-between text-xs text-gray-400 mb-1">
            <span>You Receive</span>
            <span>Rate: 1M PBJ / ETH</span>
          </div>

          <div class="bg-black/60 rounded-xl p-3 border border-gray-700 flex items-center gap-2">
            <input type="text" id="pbjOutput" readonly class="bg-transparent text-white text-lg w-full outline-none font-mono cursor-not-allowed" placeholder="0">
            <span class="font-bold text-green-500 text-sm">PBJ</span>
          </div>

          <button id="buyBtn" disabled class="w-full action-btn text-white font-bold py-4 rounded-xl pixel-font text-xs mt-2 tracking-widest">
            CONNECT TO BUY
          </button>

          <div class="text-center mt-2">
            <p class="text-[10px] text-gray-500 mb-1">Contract Address:</p>
            <code class="text-[9px] bg-gray-900 px-2 py-1 rounded text-gray-400 break-all select-all">0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5</code>
          </div>
        </div>
      </div>
      <div class="relative group hidden md:block">
        <img src="https://placehold.co/600x600/05100a/39ff14?text=PEPE+SWAP" alt="Pepe Swap" class="relative rounded-2xl shadow-2xl w-full border border-gray-800 opacity-90 hover:opacity-100 transition">
      </div>
    </section>

    <!-- GAMES LOBBY -->
    <section id="games">
      <h2 class="text-xl md:text-2xl text-white mb-6 flex items-center gap-2">
        <span class="text-green-500 pixel-font">GAMES LOBBY</span>
      </h2>
      
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <!-- Blackjack (On Page) -->
        <a href="#blackjack" class="game-card group">
          <img src="https://placehold.co/400x300/064e3b/39ff14?text=Blackjack+Live" alt="Blackjack">
          <div class="p-3 bg-gray-900 border-t border-gray-800">
            <h3 class="text-xs text-white font-bold pixel-font">Blackjack</h3>
            <p class="text-[10px] text-gray-500">On-Chain Dealer</p>
          </div>
          <div class="play-overlay"><span class="action-btn px-4 py-2 rounded text-xs font-bold text-white">PLAY NOW</span></div>
        </a>

        <!-- Slots -->
        <a href="games/tragamonedas.html" class="game-card group">
          <img src="/games/media/trgamonedas-hero.jpg" alt="Slots">
          <div class="p-3 bg-gray-900 border-t border-gray-800">
            <h3 class="text-xs text-white font-bold pixel-font">Pepe Slots</h3>
            <p class="text-[10px] text-gray-500">Spin & Win</p>
          </div>
          <div class="play-overlay"><span class="action-btn px-4 py-2 rounded text-xs font-bold text-white">SPIN</span></div>
        </a>

        <!-- Roulette -->
        <a href="games/ruleta.html" class="game-card group">
          <img src="https://placehold.co/400x300/7f1d1d/fca5a5?text=Royal+Roulette" alt="Roulette">
          <div class="p-3 bg-gray-900 border-t border-gray-800">
            <h3 class="text-xs text-white font-bold pixel-font">Roulette</h3>
            <p class="text-[10px] text-gray-500">European Style</p>
          </div>
          <div class="play-overlay"><span class="action-btn px-4 py-2 rounded text-xs font-bold text-white">BET</span></div>
        </a>

        <!-- Plinko -->
        <a href="games/plinko.html" class="game-card group">
          <img src="https://placehold.co/400x300/be185d/f9a8d4?text=Plinko+X1000" alt="Plinko">
          <div class="p-3 bg-gray-900 border-t border-gray-800">
            <h3 class="text-xs text-white font-bold pixel-font">Plinko</h3>
            <p class="text-[10px] text-gray-500">High Volatility</p>
          </div>
          <div class="play-overlay"><span class="action-btn px-4 py-2 rounded text-xs font-bold text-white">DROP</span></div>
        </a>

        <!-- Poker -->
        <a href="games/poker.html" class="game-card group">
          <img src="https://placehold.co/400x300/1e3a8a/93c5fd?text=Texas+Holdem" alt="Poker">
          <div class="p-3 bg-gray-900 border-t border-gray-800">
            <h3 class="text-xs text-white font-bold pixel-font">Poker</h3>
            <p class="text-[10px] text-gray-500">Video Poker</p>
          </div>
          <div class="play-overlay"><span class="action-btn px-4 py-2 rounded text-xs font-bold text-white">DEAL</span></div>
        </a>

        <!-- Dice -->
        <a href="games/dados.html" class="game-card group">
          <img src="https://placehold.co/400x300/b45309/fcd34d?text=Cyber+Dice" alt="Dice">
          <div class="p-3 bg-gray-900 border-t border-gray-800">
            <h3 class="text-xs text-white font-bold pixel-font">Cyber Dice</h3>
            <p class="text-[10px] text-gray-500">Hi-Lo Game</p>
          </div>
          <div class="play-overlay"><span class="action-btn px-4 py-2 rounded text-xs font-bold text-white">ROLL</span></div>
        </a>
      </div>
    </section>

    <!-- BLACKJACK TABLE (VISUAL UPGRADE) -->
    <section id="blackjack" class="space-y-6 pt-10 border-t border-gray-800">
      <div class="text-center space-y-2">
        <h2 class="text-xl md:text-2xl text-green-400 pixel-font">BLACKJACK TABLE</h2>
        <p class="text-xs text-gray-400">Status: <span id="gameState" class="text-white font-bold">Open</span></p>
      </div>

      <!-- Table Container -->
      <div class="relative max-w-4xl mx-auto">
        <div class="table-felt min-h-[450px] flex flex-col justify-between relative">
          <div class="table-line"></div>
          
          <!-- Dealer Area -->
          <div class="flex flex-col items-center gap-2 z-10">
            <div class="bg-black/60 text-white px-4 py-1 rounded-full border border-white/10 shadow-lg backdrop-blur-sm">
              <span class="text-[10px] text-gray-400 uppercase tracking-widest mr-2">DEALER</span>
              <span id="dealerScore" class="font-mono font-bold text-green-400">0</span>
            </div>
            <div id="dealerArea" class="flex justify-center gap-2 md:gap-4 min-h-[110px] perspective-500">
              <!-- Cards go here -->
            </div>
          </div>

          <!-- Result Message -->
          <div id="resultMsg" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-30 pointer-events-none transition-all w-full text-center px-4"></div>

          <!-- Player Area -->
          <div class="flex flex-col items-center gap-4 z-10 pb-4">
            <div id="playerArea" class="flex justify-center gap-2 md:gap-4 min-h-[110px]">
               <!-- Cards go here -->
            </div>
            <div class="bg-black/80 px-6 py-2 rounded-xl border border-green-500/50 shadow-[0_0_20px_rgba(34,197,94,0.3)] flex items-center gap-6 backdrop-blur-md">
               <div>
                 <p class="text-[10px] text-gray-400 uppercase">YOUR SCORE</p>
                 <p id="playerScore" class="text-white font-bold text-center text-lg">0</p>
               </div>
               <div class="h-8 w-px bg-gray-600"></div>
               <div>
                 <p class="text-[10px] text-gray-400 uppercase">CURRENT BET</p>
                 <p class="text-green-400 font-bold text-center text-lg"><span id="activeBetDisplay">0</span> PBJ</p>
               </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Controls -->
      <div class="glass-panel p-4 max-w-xl mx-auto mt-4">
        <div class="flex flex-wrap items-center justify-center gap-4 mb-3">
          <span class="text-xs text-gray-400">Info:</span>
          <span id="betStatus" class="text-xs font-mono text-yellow-400">Place your bet to start</span>
        </div>
        
        <!-- Pre-Game Controls -->
        <div class="flex flex-wrap items-center justify-center gap-3" id="bettingControls">
          <div class="flex items-center bg-black/40 rounded-lg border border-gray-700 overflow-hidden">
            <span class="px-3 text-gray-500 text-[10px] font-bold">BET</span>
            <input type="number" id="betAmount" value="1000" step="100" class="w-28 bg-transparent p-3 text-white outline-none font-mono text-sm font-bold">
            <span class="pr-3 text-gray-500 text-[10px]">PBJ</span>
          </div>
          <button id="btnDeal" class="action-btn text-white px-8 py-3 rounded-lg pixel-font text-xs tracking-wide">DEAL CARDS</button>
        </div>
        
        <!-- In-Game Controls -->
        <div class="hidden flex-wrap items-center justify-center gap-2 md:gap-4" id="playControls">
          <button id="btnHit" class="bg-blue-600 hover:bg-blue-500 border-b-4 border-blue-800 active:border-0 active:translate-y-1 text-white px-5 py-3 rounded-lg pixel-font text-[10px] transition-all shadow-lg">HIT</button>
          <button id="btnStand" class="bg-red-600 hover:bg-red-500 border-b-4 border-red-800 active:border-0 active:translate-y-1 text-white px-5 py-3 rounded-lg pixel-font text-[10px] transition-all shadow-lg">STAND</button>
          <button id="btnDouble" class="bg-yellow-600 hover:bg-yellow-500 border-b-4 border-yellow-800 active:border-0 active:translate-y-1 text-white px-5 py-3 rounded-lg pixel-font text-[10px] transition-all shadow-lg">DOUBLE</button>
          <button id="btnCancel" class="bg-gray-600 hover:bg-gray-500 border-b-4 border-gray-800 active:border-0 active:translate-y-1 text-white px-5 py-3 rounded-lg pixel-font text-[10px] transition-all shadow-lg">GIVE UP</button>
        </div>
      </div>
    </section>

    <!-- STAKING & NFTS -->
    <section id="staking" class="grid md:grid-cols-2 gap-8 pt-10">
      <div class="glass-panel p-6 border-t-4 border-t-green-500">
         <h2 class="text-lg text-white pixel-font mb-4 text-center">NFT STAKING</h2>
         <div class="flex justify-between items-center bg-black/40 p-4 rounded-lg mb-4 border border-gray-800">
           <div><p class="text-xs text-gray-400">Staked</p><p id="sim-staked-count" class="text-xl text-white">0 NFT</p></div>
           <div><p class="text-xs text-gray-400">APY</p><p class="text-xl text-green-400">350%</p></div>
         </div>
         <div class="text-center mb-4">
           <p class="text-xs text-gray-500 mb-1">Pending Rewards</p>
           <p id="sim-rewards" class="text-3xl font-mono text-green-400">0.0000</p>
           <p class="text-xs text-green-700">PBJ Tokens</p>
         </div>
         <button onclick="claimSimRewards()" class="w-full bg-gray-800 hover:bg-green-600 hover:text-black text-white py-3 rounded pixel-font text-xs transition">CLAIM</button>
      </div>
      
      <div class="glass-panel p-6">
        <h2 class="text-lg text-white pixel-font mb-4 text-center">MINT NFT</h2>
        <div class="grid grid-cols-3 gap-2 mb-4">
           <div class="bg-gray-900 p-2 rounded text-center border border-gray-700 cursor-pointer hover:border-green-500" onclick="buyNFT(0)">
             <div class="text-2xl mb-1">üê∏</div>
             <p class="text-[9px] text-gray-400">Common</p>
           </div>
           <div class="bg-gray-900 p-2 rounded text-center border border-gray-700 cursor-pointer hover:border-blue-500" onclick="buyNFT(1)">
             <div class="text-2xl mb-1">üé©</div>
             <p class="text-[9px] text-gray-400">Rare</p>
           </div>
           <div class="bg-gray-900 p-2 rounded text-center border border-gray-700 cursor-pointer hover:border-purple-500" onclick="buyNFT(2)">
             <div class="text-2xl mb-1">üëë</div>
             <p class="text-[9px] text-gray-400">Legend</p>
           </div>
        </div>
        <div class="text-[10px] text-gray-500 text-center mt-4">
          *Minting gives +10% staking boost per tier.
        </div>
      </div>
    </section>

    <!-- TOKENOMICS -->
    <section id="tokenomics" class="grid md:grid-cols-2 gap-10 pt-10 pb-10 border-t border-gray-800">
      <div class="flex flex-col items-center justify-center">
        <h2 class="text-xl text-white mb-6 pixel-font">DISTRIBUTION</h2>
        <div class="pie-chart"></div>
      </div>
      <div class="flex flex-col justify-center space-y-4">
        <h2 class="text-xl text-white mb-4 pixel-font">ROADMAP</h2>
        <div class="border-l-2 border-green-900 pl-4 space-y-4">
          <div><h4 class="text-green-400 text-xs font-bold">Q1 2025</h4><p class="text-[10px] text-gray-500">Presale & Blackjack Launch</p></div>
          <div><h4 class="text-blue-400 text-xs font-bold">Q2 2025</h4><p class="text-[10px] text-gray-500">NFT Staking & Slots</p></div>
          <div><h4 class="text-purple-400 text-xs font-bold">Q3 2025</h4><p class="text-[10px] text-gray-500">Mobile App & CEX</p></div>
        </div>
      </div>
    </section>

  </main>

  <footer class="border-t border-white/10 bg-black/80 py-8 mt-12">
    <div class="max-w-6xl mx-auto px-4 text-center">
      <div class="flex justify-center gap-4 text-gray-400 text-xs mb-4">
        <a href="#" class="hover:text-green-400">Smart Contract</a>
        <a href="#" class="hover:text-green-400">Twitter</a>
        <a href="#" class="hover:text-green-400">Telegram</a>
      </div>
      <p class="text-[10px] text-gray-700 font-mono">¬© 2025 PBJ CASINO. Not financial advice.</p>
    </div>
  </footer>

  <!-- LOGIC -->
  <script>
    // === UI HELPERS ===
    const toast = (msg, type = 'success') => {
      const c = document.getElementById('toast-container');
      const t = document.createElement('div');
      t.className = `toast ${type}`; t.textContent = msg; c.appendChild(t);
      setTimeout(() => { t.style.opacity='0'; setTimeout(()=>t.remove(), 300); }, 3000);
    };
    const formatNum = (n) => new Intl.NumberFormat('en-US').format(n);

    // === SIMULATIONS ===
    setInterval(() => {
      const el = document.getElementById('online-count');
      el.textContent = formatNum(parseInt(el.textContent.replace(',','')) + (Math.random()>0.5?1:-1)*Math.floor(Math.random()*5));
    }, 3000);

    const winners = ["0x4a..9f won 500 PBJ", "PepeKing won 1200 PBJ", "Whale01 won 5000 PBJ", "CryptoChad won 300 PBJ"];
    setInterval(() => {
      const el = document.getElementById('winner-ticker');
      el.textContent = "üî• " + winners[Math.floor(Math.random()*winners.length)];
    }, 5000);

    // Staking Sim
    let staked = 0, rewards = 0, rInt;
    window.stakeSimItem = (btn) => {
      btn.textContent = "LOCKED"; btn.disabled = true; staked++;
      document.getElementById('sim-staked-count').textContent = staked + " NFT";
      if(!rInt) rInt = setInterval(()=>{ rewards+=0.001*staked; document.getElementById('sim-rewards').textContent=rewards.toFixed(4); },100);
    };
    window.claimSimRewards = () => {
      if(rewards<=0) return toast("Nothing to claim", "error");
      toast(`Claimed ${rewards.toFixed(2)} PBJ`, "success"); confetti(); rewards=0;
    };

    // === WEB3 & ON-CHAIN LOGIC ===
    let provider, signer, userAddress;
    let pbjContract, casinoContract, presaleContract;
    
    const rate = 1000000;
    // Configurar Contratos
    const contractAddress='0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5';
    const pbjTokenAddress='0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5';
    const casinoAddress='0x79e617b64eae98bda7f8Cd4b1EdC05dE696E4B74';
    const nftAddress='0x4AabC024D719240e98e82930EAC04bD49CB86E31';

    const pbjAbi = ['function balanceOf(address) view returns (uint256)','function approve(address, uint256) returns (bool)','function allowance(address, address) view returns (uint256)'];
    const casinoAbi = ['function placeBet(uint256) external','function finishGame(bool) external','function cancelBet() external'];
    const presaleAbi = ['function buyTokens() payable'];
    const nftAbi = ['function mint(uint8) external'];

    // NETWORK CHECK
    async function checkNetwork() {
      const net = await provider.getNetwork();
      if(net.chainId === 8453) return true; // Base Mainnet
      try {
        await provider.send("wallet_switchEthereumChain", [{ chainId: "0x2105" }]); // 8453 hex
        return true;
      } catch(e) {
        toast("Please switch wallet to Base Network", "error");
        return false;
      }
    }

    // CONNECT FLOW (Improved for Mobile Injection)
    async function connectFlow() {
      const btn = document.getElementById('connectBtn');
      if(btn.textContent === "CONNECTING...") return;
      btn.textContent = "CONNECTING...";

      try {
        // 1. Try Injected Provider (TrustWallet/MetaMask App)
        if (window.ethereum) {
          provider = new ethers.providers.Web3Provider(window.ethereum, "any");
          await provider.send("eth_requestAccounts", []);
        } 
        // 2. Fallback to WalletConnect (Desktop/No Extension)
        else {
          const { default: EthereumProvider } = await import("https://esm.sh/@walletconnect/ethereum-provider@2.11.1");
          const wcProvider = await EthereumProvider.init({
            projectId: "06606e3b978574fe1fe67024c91c5aa3", chains: [8453], showQrModal: true,
            rpcMap: { 8453: "https://mainnet.base.org" }
          });
          await wcProvider.enable();
          provider = new ethers.providers.Web3Provider(wcProvider, "any");
        }

        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        
        if(await checkNetwork()) {
          // Init Contracts
          pbjContract = new ethers.Contract(pbjTokenAddress, pbjAbi, signer);
          casinoContract = new ethers.Contract(casinoAddress, casinoAbi, signer);
          presaleContract = new ethers.Contract(contractAddress, presaleAbi, signer);
          
          // Update UI
          btn.textContent = userAddress.substring(0,5) + ".." + userAddress.substring(38);
          btn.classList.replace('bg-green-600','bg-gray-800');
          document.getElementById('walletDisplay').classList.remove('hidden');
          document.getElementById('walletDisplay').classList.add('flex');
          document.getElementById('buyBtn').textContent = "BUY PBJ";
          document.getElementById('buyBtn').disabled = false;

          toast("Wallet Connected Successfully");
          updateBalances();
        }
      } catch(e) {
        console.error(e);
        toast("Connection Failed", "error");
        btn.textContent = "CONNECT";
      }
    }

    async function updateBalances() {
      try {
        const eth = await provider.getBalance(userAddress);
        document.getElementById('ethBalance').textContent = parseFloat(ethers.utils.formatEther(eth)).toFixed(4);
        
        const pbj = await pbjContract.balanceOf(userAddress);
        document.getElementById('pbjBalanceHeader').textContent = formatNum(parseInt(ethers.utils.formatUnits(pbj, 18)));
      } catch(e){}
    }

    document.getElementById('connectBtn').addEventListener('click', connectFlow);

    // === BUY SECTION LOGIC ===
    const ethIn = document.getElementById('ethInput');
    const pbjOut = document.getElementById('pbjOutput');
    
    ethIn.addEventListener('input', (e) => {
      const val = parseFloat(e.target.value);
      pbjOut.value = val ? formatNum(Math.floor(val * rate)) : 0;
    });

    document.getElementById('maxBtn').addEventListener('click', async () => {
      if(!provider) return toast("Connect wallet first", "error");
      const bal = await provider.getBalance(userAddress);
      // Leave 0.002 for gas
      const max = bal.sub(ethers.utils.parseEther("0.002"));
      if(max.gt(0)) {
        const val = ethers.utils.formatEther(max);
        ethIn.value = parseFloat(val).toFixed(4);
        ethIn.dispatchEvent(new Event('input'));
      } else {
        toast("Insufficient ETH for gas", "error");
      }
    });

    document.getElementById('buyBtn').addEventListener('click', async () => {
      const val = parseFloat(ethIn.value);
      if(!val || val <= 0) return toast("Invalid Amount", "error");
      
      const btn = document.getElementById('buyBtn');
      btn.textContent = "CONFIRMING..."; btn.disabled = true;

      try {
        const tx = await presaleContract.buyTokens({ value: ethers.utils.parseEther(val.toString()) });
        btn.textContent = "MINING...";
        await tx.wait();
        toast("Purchase Successful!", "success"); confetti();
        updateBalances();
        ethIn.value = ""; pbjOut.value = "";
      } catch(e) {
        console.error(e);
        toast("Transaction Failed", "error");
      } finally {
        btn.textContent = "BUY PBJ"; btn.disabled = false;
      }
    });

    // === NFT MINT ===
    window.buyNFT = async (tier) => {
      if(!provider) return toast("Connect Wallet", "error");
      try {
         const nft = new ethers.Contract(nftAddress, nftAbi, signer);
         // Example check allowance would go here
         toast("Minting NFT...", "success");
         const tx = await nft.mint(tier);
         await tx.wait();
         toast("NFT Minted!", "success"); confetti();
         stakeSimItem({textContent:'', disabled:false, classList:{replace:()=>{}}}); // Auto stake sim for demo
      } catch(e) { toast("Mint Failed", "error"); }
    };

    // === BLACKJACK ENGINE ===
    let deck=[], pHand=[], dHand=[], gameActive=false;
    const ui = { deal:document.getElementById('btnDeal'), hit:document.getElementById('btnHit'), stand:document.getElementById('btnStand'), double:document.getElementById('btnDouble'), cancel:document.getElementById('btnCancel') };

    function buildDeck() { const s=['‚ô†','‚ô•','‚ô¶','‚ô£'], v=['A','2','3','4','5','6','7','8','9','10','J','Q','K']; deck=[]; s.forEach(S=>v.forEach(V=>deck.push({s:S,v:V}))); deck.sort(()=>Math.random()-0.5); }
    function val(c){ if(c.v==='A')return 11; if(['K','Q','J'].includes(c.v))return 10; return parseInt(c.v); }
    function score(h){ let s=0,a=0; h.forEach(c=>{s+=val(c); if(c.v==='A')a++}); while(s>21&&a>0){s-=10;a--} return s; }
    function cardHTML(c,hide){
       if(hide) return `<div class="card bg-blue-900 border-2 border-white flex items-center justify-center text-white text-2xl reveal">?</div>`;
       const col = (c.s==='‚ô•'||c.s==='‚ô¶')?'red':'black';
       return `<div class="card ${col} reveal"><span class="corner-val tl">${c.v}<br>${c.s}</span>${c.s}<span class="corner-val br">${c.v}<br>${c.s}</span></div>`;
    }
    function render(hideD=true){
       document.getElementById('dealerArea').innerHTML = dHand.map((c,i)=>cardHTML(c,hideD&&i===1)).join('');
       document.getElementById('playerArea').innerHTML = pHand.map(c=>cardHTML(c)).join('');
       document.getElementById('playerScore').textContent = score(pHand);
       document.getElementById('dealerScore').textContent = hideD ? "?" : score(dHand);
    }
    function toggleControls(on){
       document.getElementById('bettingControls').classList.toggle('hidden', on);
       document.getElementById('bettingControls').classList.toggle('flex', !on);
       document.getElementById('playControls').classList.toggle('hidden', !on);
       document.getElementById('playControls').classList.toggle('flex', on);
    }
    function msg(txt, type){
       const el = document.getElementById('resultMsg');
       const bg = type==='win'?'bg-green-600':type==='lose'?'bg-red-600':'bg-gray-600';
       el.innerHTML = `<div class="${bg} text-white px-6 py-3 rounded-full shadow-xl border-2 border-white animate-bounce font-bold tracking-wider">${txt}</div>`;
       if(type==='win') confetti();
       setTimeout(()=>el.innerHTML='', 3000);
    }

    ui.deal.addEventListener('click', async () => {
       if(!casinoContract) return toast("Connect Wallet first", "error");
       const amt = document.getElementById('betAmount').value;
       ui.deal.textContent = "PLACING BET..."; ui.deal.disabled=true;

       try {
         // 1. Chain Logic
         const raw = ethers.utils.parseUnits(amt, 18);
         if((await pbjContract.allowance(userAddress, casinoAddress)).lt(raw)) {
            toast("Approving Token...");
            await (await pbjContract.approve(casinoAddress, ethers.constants.MaxUint256)).wait();
         }
         const tx = await casinoContract.placeBet(raw);
         await tx.wait();

         // 2. Game Logic
         buildDeck(); pHand=[deck.pop(),deck.pop()]; dHand=[deck.pop(),deck.pop()];
         gameActive=true; document.getElementById('activeBetDisplay').textContent=amt;
         render(true); toggleControls(true);
         
         if(score(pHand)===21) {
            msg("BLACKJACK!", "win"); await (await casinoContract.finishGame(true)).wait(); reset();
         }
       } catch(e) { toast("Bet Failed", "error"); }
       finally { ui.deal.textContent="DEAL CARDS"; ui.deal.disabled=false; }
    });

    ui.hit.addEventListener('click', ()=>{
       pHand.push(deck.pop()); render(true);
       if(score(pHand)>21) { msg("BUST!", "lose"); end(false); }
    });

    ui.stand.addEventListener('click', async ()=>{
       while(score(dHand)<17) { await new Promise(r=>setTimeout(r,800)); dHand.push(deck.pop()); render(false); }
       const p=score(pHand), d=score(dHand);
       if(d>21 || p>d) { msg("YOU WIN!", "win"); end(true); }
       else if(p===d) { msg("PUSH", "push"); end(false); }
       else { msg("HOUSE WINS", "lose"); end(false); }
    });

    async function end(win){ try{ await (await casinoContract.finishGame(win)).wait(); updateBalances(); reset(); }catch(e){} }
    function reset(){ gameActive=false; toggleControls(false); }

    // Timer
    setInterval(()=>{
      const d = Math.max(0, (1719999999999) - Date.now()); // Example date
      document.getElementById('presale-countdown').textContent = d>0 ? Math.floor(d/86400000)+"d left" : "Ended";
    }, 1000);

  </script>
</body>
</html>


