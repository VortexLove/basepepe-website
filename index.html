<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
  <title>PBJ - Premium Crypto Casino</title>
  <meta name="description" content="The #1 DeFi Casino on Base." />

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- External Libs -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Inter"', 'sans-serif'],
            mono: ['"Rajdhani"', 'monospace'],
            pixel: ['"Rajdhani"', 'monospace'], /* Mapping pixel font to Rajdhani for modern look */
          },
          colors: {
            bg: '#0F212E',       
            sidebar: '#1A2C38',  
            surface: '#213743',  
            surfaceHover: '#2C4454',    
            primary: '#00E701', /* Neon Green */ 
            neon: '#00E701',
            accent: '#1475E1',   
            danger: '#FF4949',
          },
          animation: {
            'marquee': 'marquee 30s linear infinite',
            'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          },
          keyframes: {
            marquee: {
              '0%': { transform: 'translateX(0%)' },
              '100%': { transform: 'translateX(-100%)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    body { background-color: #0F212E; color: #b1bad3; overflow-x: hidden; }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0F212E; }
    ::-webkit-scrollbar-thumb { background: #2C4454; border-radius: 10px; }

    /* Inputs & Buttons */
    .casino-input {
      background: #0F212E; border: 2px solid #2C4454; color: white;
      font-family: 'Rajdhani'; font-weight: 700; transition: all 0.2s;
    }
    .casino-input:focus { border-color: #00E701; outline: none; }

    .btn-primary {
      background: #00E701; color: #0b1820; font-weight: 800;
      transition: all 0.2s; border-radius: 0.25rem; letter-spacing: 0.5px;
    }
    .btn-primary:hover:not(:disabled) { background: #1aff1b; transform: translateY(-1px); box-shadow: 0 0 15px rgba(0,231,1,0.4); }
    .btn-primary:disabled { background: #2C4454; color: #55657e; cursor: not-allowed; }

    /* --- ANIMATIONS FROM ORIGINAL SCRIPT COMPATIBILITY --- */
    .blur-anim { filter: blur(2px); animation: shake 0.1s infinite; }
    .shaking { animation: shake 0.1s infinite; }
    @keyframes shake { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -1px); } 100% { transform: translate(1px, -1px); } }
    
    /* Toast */
    .slide-in { animation: slideIn 0.3s forwards; }
    @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

    /* Visual Cards (Generated by Script) */
    .card-visual {
        width: 50px; height: 75px; background: white; border-radius: 6px;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        font-weight: 800; font-family: 'Inter', sans-serif; font-size: 18px; line-height: 1;
        box-shadow: 2px 2px 5px rgba(0,0,0,0.5); margin: 0 4px;
    }
    .card-red { color: #ef4444; } .card-black { color: #171717; }

    /* Live Feed Ticker */
    .ticker-wrap { width: 100%; overflow: hidden; background: #1A2C38; border-bottom: 1px solid #2C4454; height: 40px; }
    .ticker { display: flex; height: 100%; align-items: center; white-space: nowrap; animation: marquee 30s linear infinite; }
    .ticker-item { display: inline-flex; align-items: center; padding: 0 2rem; color: #b1bad3; font-size: 0.75rem; font-family: 'Rajdhani'; font-weight: 600; }
  </style>
</head>
<body class="flex h-screen text-sm antialiased font-sans selection:bg-primary selection:text-black">

  <!-- TOAST CONTAINER -->
  <div id="toast-container" class="fixed bottom-5 right-5 z-[10000] flex flex-col gap-2"></div>

  <!-- GAME MODAL (ID Matches Script) -->
  <div id="gameModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[9990] hidden items-center justify-center p-4">
    <div class="bg-sidebar w-full max-w-lg rounded-xl shadow-2xl border border-gray-700 overflow-hidden flex flex-col max-h-[90vh]">
        <!-- Header -->
        <div class="bg-surface p-4 flex justify-between items-center border-b border-gray-700">
            <div class="flex items-center gap-3">
                <span id="modalIcon" class="text-2xl">üé∞</span>
                <div>
                    <h2 id="modalTitle" class="text-white font-bold text-lg uppercase tracking-wide">GAME</h2>
                    <div class="flex items-center gap-1 text-xs text-green-400">
                        <i class="fas fa-shield-alt"></i> <span>Provably Fair</span>
                    </div>
                </div>
            </div>
            <button onclick="closeGame()" class="text-gray-400 hover:text-white transition w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-700"><i class="fas fa-times"></i></button>
        </div>

        <!-- Content (Script Injects Here) -->
        <div class="flex-1 bg-[#0b1820] relative p-6 flex items-center justify-center overflow-y-auto min-h-[300px]">
            <div id="innerGameContent" class="w-full flex flex-col items-center justify-center"></div>
        </div>
        
        <!-- Status Msg -->
        <div id="gameStatus" class="bg-[#0b1820] pb-2 text-center text-xs font-mono uppercase tracking-widest text-gray-500">READY</div>

        <!-- Controls -->
        <div class="bg-sidebar p-4 border-t border-gray-700">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-[#0F212E] p-1.5 rounded-lg border border-gray-700 focus-within:border-primary transition">
                    <div class="flex justify-between px-2 pt-1 text-[10px] text-gray-400 uppercase font-bold">
                        <span>Bet Amount</span>
                        <span>Bal: <span id="modalBalance" class="text-white">0</span></span>
                    </div>
                    <div class="flex items-center gap-2 mt-1">
                        <span class="text-primary pl-2"><i class="fas fa-coins"></i></span>
                        <input type="number" id="gameBetInput" value="100" class="bg-transparent w-full text-white font-mono font-bold focus:outline-none" placeholder="0.00">
                    </div>
                </div>
                <div class="flex gap-2 h-full">
                    <button id="gameActionBtn" class="btn-primary w-full h-full text-base">PLAY</button>
                    <!-- Extra controls injected by script -->
                    <div id="gameExtraControls" class="hidden flex-1 gap-2 w-full flex"></div>
                </div>
            </div>
        </div>
    </div>
  </div>

  <!-- SIDEBAR -->
  <aside class="hidden md:flex w-64 flex-col bg-sidebar border-r border-gray-800 flex-shrink-0 z-20">
    <div class="h-16 flex items-center px-6 border-b border-gray-800">
      <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center mr-3 text-black font-bold text-lg transform rotate-3">P</div>
      <span class="text-white font-bold text-xl tracking-tight">PBJ<span class="text-primary">.BET</span></span>
    </div>

    <div class="flex-1 overflow-y-auto py-6 px-3 space-y-1">
      <div class="px-3 mb-2 text-xs font-bold text-gray-500 uppercase tracking-wider">Casino</div>
      <a href="#games" class="flex items-center px-3 py-2.5 bg-surface text-white rounded-lg transition border-l-2 border-primary">
        <i class="fas fa-dice w-6 text-primary"></i> <span class="font-medium">Lobby</span>
      </a>
      <a href="#presale" class="flex items-center px-3 py-2.5 text-gray-400 hover:text-white hover:bg-surfaceHover rounded-lg transition">
        <i class="fas fa-rocket w-6"></i> <span class="font-medium">Presale</span>
        <span class="ml-auto bg-primary text-black text-[9px] font-bold px-1.5 py-0.5 rounded">HOT</span>
      </a>
      <a href="#minting" class="flex items-center px-3 py-2.5 text-gray-400 hover:text-white hover:bg-surfaceHover rounded-lg transition">
        <i class="fas fa-store w-6"></i> <span class="font-medium">Mint NFT</span>
      </a>
      <a href="#staking" class="flex items-center px-3 py-2.5 text-gray-400 hover:text-white hover:bg-surfaceHover rounded-lg transition">
        <i class="fas fa-vault w-6"></i> <span class="font-medium">Staking</span>
      </a>
      <a href="#partners" class="flex items-center px-3 py-2.5 text-gray-400 hover:text-white hover:bg-surfaceHover rounded-lg transition">
        <i class="fas fa-handshake w-6"></i> <span class="font-medium">Partners</span>
      </a>
    </div>

    <div class="p-4 border-t border-gray-800">
        <div class="bg-surface p-3 rounded-lg border border-gray-700">
            <div class="text-xs text-gray-400 mb-1">Total Paid Out</div>
            <div class="text-primary font-mono font-bold text-lg">$1,245,290.00</div>
        </div>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <div class="flex-1 flex flex-col h-screen overflow-hidden relative">
    
    <!-- TOP NAVBAR -->
    <header class="h-16 bg-sidebar/90 backdrop-blur border-b border-gray-800 flex items-center justify-between px-4 sticky top-0 z-30">
      <div class="md:hidden flex items-center gap-3">
          <div class="w-8 h-8 bg-primary rounded flex items-center justify-center font-bold text-black">P</div>
      </div>

      <!-- Live Users -->
      <div class="flex items-center gap-6">
          <div class="hidden md:flex items-center gap-2 bg-[#0F212E] border border-gray-700 px-3 py-1.5 rounded-full">
              <span class="relative flex h-2 w-2">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
              </span>
              <span class="text-xs font-mono font-bold text-gray-300">1,420 Online</span>
          </div>
      </div>

      <!-- Wallet -->
      <div class="flex items-center gap-3">
         <div id="walletDisplay" class="hidden flex-col items-end mr-1">
            <div class="bg-[#0F212E] px-3 py-1 rounded border border-gray-700 flex items-center gap-2">
                <span id="headerBalance" class="text-white font-mono font-bold text-sm">0</span>
                <span class="text-primary text-xs font-bold">PBJ</span>
            </div>
        </div>
        <button id="connectBtn" class="btn-primary px-4 py-2 text-xs md:text-sm shadow-[0_0_10px_rgba(0,231,1,0.2)]">
            <i class="fas fa-wallet mr-1"></i> CONNECT
        </button>
      </div>
    </header>

    <!-- SCROLLABLE MAIN -->
    <main class="flex-1 overflow-y-auto bg-bg relative">
      
      <!-- HERO / PRESALE -->
      <div id="presale" class="p-4 md:p-8 pb-0">
          <section class="relative rounded-2xl overflow-hidden bg-gradient-to-r from-[#0b1d2e] to-[#162b3b] shadow-2xl border border-white/5">
            <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
            
            <!-- BONUS BANNER (25%) -->
            <div class="absolute top-0 left-0 w-full bg-primary/20 border-b border-primary/50 text-center py-1 z-20">
                <p class="text-[10px] md:text-xs font-bold text-primary animate-pulse">
                    ‚ö° SPECIAL OFFER: +25% BONUS TOKENS ENDS IN <span id="bonusTimer" class="font-mono text-white">01:59:59</span> ‚ö°
                </p>
            </div>

            <div class="relative z-10 grid md:grid-cols-2 gap-8 p-6 md:p-10 pt-12 items-center">
                <div class="space-y-5">
                    <h1 class="text-3xl md:text-5xl font-bold text-white leading-tight">
                        Presale Ends In:
                    </h1>
                    
                    <!-- COUNTDOWN TIMER -->
                    <div class="flex gap-4 font-mono text-center">
                        <div class="bg-black/40 p-3 rounded-lg border border-primary/30 min-w-[70px]">
                            <span id="d" class="text-2xl md:text-3xl font-bold text-primary">5</span>
                            <div class="text-[10px] text-gray-500">DAYS</div>
                        </div>
                        <div class="bg-black/40 p-3 rounded-lg border border-primary/30 min-w-[70px]">
                            <span id="h" class="text-2xl md:text-3xl font-bold text-white">00</span>
                            <div class="text-[10px] text-gray-500">HRS</div>
                        </div>
                        <div class="bg-black/40 p-3 rounded-lg border border-primary/30 min-w-[70px]">
                            <span id="m" class="text-2xl md:text-3xl font-bold text-white">00</span>
                            <div class="text-[10px] text-gray-500">MINS</div>
                        </div>
                        <div class="bg-black/40 p-3 rounded-lg border border-primary/30 min-w-[70px]">
                            <span id="s" class="text-2xl md:text-3xl font-bold text-white">00</span>
                            <div class="text-[10px] text-gray-500">SECS</div>
                        </div>
                    </div>

                    <p class="text-gray-400 text-sm md:text-base max-w-md">
                        Join the protocol before public launch. 1 ETH = 1.5M PBJ.
                    </p>
                </div>

                <!-- Swap Card -->
                <div class="bg-sidebar p-1 rounded-xl shadow-2xl max-w-sm mx-auto w-full border border-gray-700 mt-6 md:mt-0">
                    <div class="bg-[#0F212E] p-5 rounded-lg space-y-4">
                        <div class="flex justify-between text-xs text-gray-400 font-bold mb-1">
                            <span>YOU PAY</span>
                        </div>
                        <div class="relative">
                            <input type="number" id="buyInput" class="casino-input w-full p-3 pr-16 rounded-lg text-lg" placeholder="0.1">
                            <div class="absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2">
                                <i class="fab fa-ethereum text-gray-300"></i> <span class="font-bold text-white text-sm">ETH</span>
                            </div>
                        </div>
                        
                        <div class="flex justify-center -my-3 relative z-10">
                             <div class="bg-sidebar p-1.5 rounded-full border border-gray-700"><i class="fas fa-arrow-down text-primary text-xs"></i></div>
                        </div>

                        <div class="relative pt-1">
                            <input type="number" id="receiveInput" readonly class="bg-sidebar border border-transparent w-full p-3 pr-16 rounded-lg text-lg text-primary font-mono font-bold" placeholder="0">
                            <div class="absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2">
                                <span class="font-bold text-white text-sm">PBJ</span>
                            </div>
                        </div>
                        <button id="buyBtn" class="w-full btn-primary py-3.5 mt-2 uppercase tracking-wider text-xs font-bold">Buy Tokens</button>
                    </div>
                </div>
            </div>
          </section>
      </div>

      <!-- LIVE TICKER (Simulated with Script) -->
      <div class="mt-8 border-y border-gray-800 bg-sidebar/50 backdrop-blur-sm">
          <div class="ticker-wrap">
              <div class="ticker">
                  <div class="ticker-item"><span class="text-primary mr-2">WIN</span> User 0x...4a won 500 PBJ on Slots</div>
                  <div class="ticker-item"><span class="text-primary mr-2">WIN</span> User 0x...b2 won 2000 PBJ on Blackjack</div>
                  <div class="ticker-item"><span class="text-primary mr-2">WIN</span> PepeKing just minted a Legendary NFT</div>
                  <div class="ticker-item"><span class="text-primary mr-2">WIN</span> User 0x...ff won 150 PBJ on Mines</div>
                  <div class="ticker-item"><span class="text-primary mr-2">WIN</span> User 0x...99 won 1200 PBJ on Crash</div>
              </div>
          </div>
      </div>

      <!-- GAMES GRID -->
      <section id="games" class="p-4 md:p-8">
        <h2 class="text-xl font-bold text-white flex items-center gap-2 mb-6"><i class="fas fa-gamepad text-primary"></i> Casino Lobby</h2>
        
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
            <!-- Game Cards with onClick triggering openGame() -->
            <div onclick="openGame('blackjack')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1605870445919-838d190e8e1b?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Blackjack</h3>
                    <p class="text-[10px] text-primary">Live Dealer</p>
                </div>
            </div>

            <div onclick="openGame('slots')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1596838132731-3301c3fd4317?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Slots</h3>
                    <p class="text-[10px] text-primary">Jackpot</p>
                </div>
            </div>

            <div onclick="openGame('mines')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1518558997970-4ddc236affcd?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Mines</h3>
                    <p class="text-[10px] text-primary">Strategy</p>
                </div>
            </div>

            <div onclick="openGame('crash')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Crash</h3>
                    <p class="text-[10px] text-primary">Multiplier</p>
                </div>
            </div>

             <div onclick="openGame('roulette')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1606167668584-78701c57f13d?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Roulette</h3>
                    <p class="text-[10px] text-primary">Classic</p>
                </div>
            </div>
             <div onclick="openGame('dice')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1563941402622-4e7a488bc294?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Dice</h3>
                    <p class="text-[10px] text-primary">Provably Fair</p>
                </div>
            </div>
             <div onclick="openGame('plinko')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1622312685799-a3597379d39c?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Plinko</h3>
                    <p class="text-[10px] text-primary">Drops</p>
                </div>
            </div>
            <div onclick="openGame('keno')" class="group relative cursor-pointer bg-surface rounded-xl overflow-hidden aspect-[3/4] hover:-translate-y-1 transition shadow-lg">
                <img src="https://images.unsplash.com/photo-1518623489648-a173ef7824f3?auto=format&fit=crop&w=400" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/90 to-transparent p-4">
                    <h3 class="text-white font-bold">Keno</h3>
                    <p class="text-[10px] text-primary">Lottery</p>
                </div>
            </div>
        </div>
      </section>

      <!-- NFT MINTING & STAKING -->
      <section id="minting" class="p-4 md:p-8 bg-[#0b1820] border-y border-gray-800">
          <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-10">
              <!-- Mint -->
              <div class="space-y-6">
                  <h2 class="text-2xl font-bold text-white">Mint Dealer NFT</h2>
                  <div class="bg-sidebar p-6 rounded-xl border border-gray-700">
                      <div class="flex justify-between items-center mb-4">
                          <span class="text-gray-400 font-bold text-xs">TIER 1 (COMMON)</span>
                          <span class="text-white font-mono font-bold">PRICE: 5000 PBJ</span>
                      </div>
                      <div class="w-full bg-gray-700 h-2 rounded-full mb-6 overflow-hidden"><div class="bg-primary h-full w-[42%]"></div></div>
                      <button onclick="mintNFT(0)" class="w-full btn-primary py-3">MINT NFT</button>
                      <div class="grid grid-cols-4 gap-2 mt-4">
                         <button onclick="mintNFT(1)" class="text-[10px] bg-surface p-2 rounded hover:bg-white hover:text-black">UNCOMMON</button>
                         <button onclick="mintNFT(2)" class="text-[10px] bg-surface p-2 rounded hover:bg-white hover:text-black">RARE</button>
                         <button onclick="mintNFT(3)" class="text-[10px] bg-surface p-2 rounded hover:bg-white hover:text-black">EPIC</button>
                         <button onclick="mintNFT(4)" class="text-[10px] bg-surface p-2 rounded hover:bg-white hover:text-black">LEGEND</button>
                      </div>
                  </div>
              </div>

              <!-- Staking / Inventory -->
              <div id="staking" class="bg-sidebar border border-gray-800 rounded-xl p-6 relative">
                  <div class="flex justify-between items-center mb-6">
                      <h2 class="text-xl font-bold text-white">Inventory & Staking</h2>
                      <button onclick="loadUserData()" class="text-xs bg-surface hover:bg-gray-700 px-3 py-1 rounded text-white"><i class="fas fa-sync mr-1"></i> Refresh</button>
                  </div>
                  
                  <div id="inventory-list" class="bg-[#0F212E] rounded-lg border border-dashed border-gray-700 h-48 overflow-y-auto p-2 mb-4">
                      <!-- Script injects items here -->
                      <p class="text-center text-gray-500 text-xs mt-10">Connect wallet to view</p>
                  </div>

                  <div class="bg-surface p-4 rounded-lg flex justify-between items-center">
                      <div>
                          <p class="text-[10px] text-gray-400">TOTAL STAKED</p>
                          <p id="total-staked" class="text-white font-bold">0 NFT</p>
                      </div>
                      <div>
                           <p class="text-[10px] text-gray-400">YIELD</p>
                          <p id="daily-yield" class="text-primary font-bold">0 PBJ/d</p>
                      </div>
                      <div class="text-right">
                          <p class="text-[10px] text-gray-400">REWARDS</p>
                          <p id="pending-rewards" class="text-white font-mono font-bold">0.00</p>
                      </div>
                  </div>
                  <button onclick="claimRewards()" class="w-full mt-2 bg-gray-700 hover:bg-white hover:text-black text-white text-xs py-2 rounded font-bold transition">CLAIM ALL REWARDS</button>
              </div>
          </div>
      </section>

      <!-- PARTNERS SECTION -->
      <section id="partners" class="p-4 md:p-8">
          <h2 class="text-xl font-bold text-white mb-6 text-center">Our Partners & Affiliates</h2>
          
          <div id="partner-locked" class="bg-sidebar border border-dashed border-gray-600 rounded-xl p-10 text-center">
              <i class="fas fa-lock text-4xl text-gray-500 mb-4"></i>
              <h3 class="text-white font-bold">Affiliate Dashboard Locked</h3>
              <p class="text-gray-400 text-sm mb-4">Connect your wallet to generate your referral link and earn 15% commissions.</p>
              <button class="btn-primary px-6 py-2 text-xs opacity-50 cursor-not-allowed">Connect Wallet First</button>
          </div>

          <div id="partner-unlocked" class="hidden bg-sidebar border border-primary/30 rounded-xl p-8">
              <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                  <div class="text-center md:text-left">
                      <h3 class="text-white font-bold text-lg">Partner Dashboard</h3>
                      <p class="text-green-400 text-sm">Status: Active Affiliate</p>
                  </div>
                  <div class="flex-1 w-full max-w-md">
                      <div class="flex bg-[#0F212E] p-2 rounded border border-gray-700">
                          <input type="text" id="refLinkInput" readonly class="bg-transparent flex-1 text-gray-400 text-xs px-2 outline-none" value="https://pbj.bet/?ref=0x...">
                          <button onclick="copyRefLink()" class="bg-primary text-black text-xs font-bold px-3 py-1 rounded hover:bg-white">COPY</button>
                      </div>
                  </div>
              </div>
              <!-- Logos Grid -->
              <div class="grid grid-cols-4 md:grid-cols-6 gap-8 mt-10 opacity-50 grayscale hover:grayscale-0 transition duration-500">
                  <div class="flex items-center justify-center"><i class="fab fa-ethereum text-4xl"></i></div>
                  <div class="flex items-center justify-center"><i class="fas fa-shield-alt text-4xl"></i></div>
                  <div class="flex items-center justify-center"><i class="fas fa-university text-4xl"></i></div>
                  <div class="flex items-center justify-center"><i class="fas fa-globe text-4xl"></i></div>
                  <div class="hidden md:flex items-center justify-center"><i class="fas fa-coins text-4xl"></i></div>
                  <div class="hidden md:flex items-center justify-center"><i class="fas fa-rocket text-4xl"></i></div>
              </div>
          </div>
      </section>

      <!-- FOOTER -->
      <footer class="bg-black/50 border-t border-gray-800 p-8 text-center text-xs text-gray-600">
          <p>&copy; 2025 PBJ Protocol. All rights reserved.</p>
      </footer>
    </main>
  </div>

  <!-- SCRIPT ORIGINAL (COPIED & ADAPTED FOR DOM IDs) -->
  <script type="module">
    import { ethers } from "https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js";

    // --- CONFIGURACI√ìN ---
    const ADDR = {
        TOKEN: "0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5",
        PRESALE: "0xff4b4f2076F39550e2C5fD44cb2024Eb06B944E5", 
        BLACKJACK: "0xbe0b8099B707e3c0bA278583C6b5561D82E77f3E",
        INSTANT: "0xbcF9DFfcDaDeC818F7B653aF1a7Ff287F3e7011f",
        NFT: "0xDE05dAf2cbF59ce9094979d639393ADED494e920"
    };

    const ABIS = {
        TOKEN: [ "function approve(address spender, uint256 amount) external returns (bool)", "function balanceOf(address account) external view returns (uint256)", "function allowance(address owner, address spender) external view returns (uint256)" ],
        PRESALE: [ "function buyTokens() payable" ],
        BLACKJACK: [ "function placeBet(uint256 amount) external", "event GameFinished(address indexed player, bool won, uint256 payout, uint256 dealerScore, uint256 playerScore)" ],
        INSTANT: [ "function playSlots(uint256 _bet) external", "function playRoulette(uint256 _bet, uint256 _choice) external", "function playDice(uint256 _bet, uint256 _rollUnder) external", "function playPlinko(uint256 _bet) external", "function playCrash(uint256 _bet, uint256 _cashoutX) external", "function playMines(uint256 _bet, uint256 _minesCount) external", "function playKeno(uint256 _bet) external", "event SlotsPlayed(address indexed player, uint256 bet, uint256 payout, uint256[3] outcome)", "event RoulettePlayed(address indexed player, uint256 bet, uint256 payout, uint256 roll, string color)", "event DicePlayed(address indexed player, uint256 bet, uint256 payout, uint256 rolled, uint256 prediction)", "event PlinkoPlayed(address indexed player, uint256 bet, uint256 payout, uint256 slot)", "event CrashPlayed(address indexed player, uint256 bet, uint256 payout, uint256 crashPoint, uint256 cashoutPoint)", "event MinesPlayed(address indexed player, uint256 bet, uint256 payout, bool exploded)", "event KenoPlayed(address indexed player, uint256 bet, uint256 payout, uint256 matches)" ],
        NFT: [ "function mint(uint256 id, uint256 amount) external", "function stake(uint256 id, uint256 amount) external", "function unstake(uint256 id, uint256 amount) external", "function claim() external", "function getPendingRewards(address user) view returns (uint256)", "function getStakedBalance(address user, uint256 id) view returns (uint256)", "function balanceOf(address account, uint256 id) view returns (uint256)", "function tierInfo(uint256 id) view returns (uint256 price, uint256 rewardPerSec, bool active)" ]
    };

    let provider, signer, address;
    let contracts = {};
    let animInterval = null;

    const toast = (msg, type='success') => {
        const c = document.getElementById('toast-container');
        const t = document.createElement('div');
        const color = type === 'error' ? 'bg-red-500 border-red-700' : 'bg-[#0F212E] border-primary';
        t.className = `slide-in px-4 py-3 text-xs font-mono uppercase text-white border-l-4 shadow-lg mb-2 rounded ${color}`;
        t.innerHTML = `<strong>> SYSTEM:</strong> ${msg}`;
        c.appendChild(t);
        setTimeout(() => t.remove(), 3000);
    };

    document.getElementById('connectBtn').addEventListener('click', async () => {
        if(!window.ethereum) return alert("Install Metamask");
        try {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            address = await signer.getAddress();
            
            contracts.token = new ethers.Contract(ADDR.TOKEN, ABIS.TOKEN, signer);
            contracts.presale = new ethers.Contract(ADDR.PRESALE, ABIS.PRESALE, signer);
            contracts.blackjack = new ethers.Contract(ADDR.BLACKJACK, ABIS.BLACKJACK, signer);
            contracts.instant = new ethers.Contract(ADDR.INSTANT, ABIS.INSTANT, signer);
            contracts.nft = new ethers.Contract(ADDR.NFT, ABIS.NFT, signer);

            updateUI();
            loadUserData();
            unlockPartners();
            listenForWins();
            toast("SYSTEM ONLINE: Wallet Connected");
        } catch(e) { console.error(e); toast("Connection Failed", "error"); }
    });

    async function updateUI() {
        document.getElementById('connectBtn').innerHTML = `<i class="fas fa-user mr-1"></i> ${address.substring(0,6)}...`;
        try {
            const bal = await contracts.token.balanceOf(address);
            const fmt = Math.floor(parseFloat(ethers.utils.formatUnits(bal, 18)));
            document.getElementById('headerBalance').innerText = fmt.toLocaleString();
            document.getElementById('modalBalance').innerText = fmt.toLocaleString();
            document.getElementById('walletDisplay').style.display = 'flex';
        } catch(e) { console.log("Dev mode (no token)"); }
    }

    function unlockPartners() {
        document.getElementById('partner-locked').classList.add('hidden');
        document.getElementById('partner-unlocked').classList.remove('hidden');
        const url = window.location.origin + window.location.pathname;
        document.getElementById('refLinkInput').value = `${url}?ref=${address}`;
    }
    window.copyRefLink = () => {
        const t = document.getElementById("refLinkInput"); t.select();
        navigator.clipboard.writeText(t.value); toast("LINK COPIED TO CLIPBOARD");
    };

    function startAnimation(game) {
        if(animInterval) clearInterval(animInterval);
        const status = document.getElementById('gameStatus');
        status.innerText = ">>> EXECUTING SMART CONTRACT...";
        status.className = "bg-[#0b1820] pb-2 text-center text-xs font-mono uppercase tracking-widest text-primary animate-pulse";

        if (game === 'slots') {
            const emojis = ['üçí','üçã','üçá','üçâ','üîî','üíé','7Ô∏è‚É£'];
            const el = document.getElementById('slotRes');
            el.classList.add('blur-anim');
            animInterval = setInterval(() => {
                el.innerText = `${emojis[Math.floor(Math.random()*7)]} ${emojis[Math.floor(Math.random()*7)]} ${emojis[Math.floor(Math.random()*7)]}`;
            }, 80);
        }
        else if (game === 'dice') {
            const el = document.getElementById('diceRes');
            el.classList.add('shaking');
            animInterval = setInterval(() => { el.innerText = Math.floor(Math.random() * 100); }, 50);
        }
        else if (game === 'crash') {
            const el = document.getElementById('crashRes');
            let val = 1.00;
            animInterval = setInterval(() => { 
                val += 0.05; 
                el.innerText = val.toFixed(2) + "x"; 
                el.style.color = "#00E701";
            }, 100);
        }
        else if (game === 'roulette') {
            const el = document.getElementById('rouletteRes');
            const colors = ['text-red-500', 'text-white'];
            el.classList.add('shaking');
            animInterval = setInterval(() => { 
                el.innerText = Math.floor(Math.random() * 37); 
                el.className = `text-6xl font-bold mb-2 ${colors[Math.floor(Math.random()*2)]}`;
            }, 80);
        }
    }

    function stopAnimation() {
        if(animInterval) clearInterval(animInterval);
        const els = document.querySelectorAll('.blur-anim, .shaking');
        els.forEach(e => e.classList.remove('blur-anim', 'shaking'));
    }

    window.openGame = (game) => {
        const m = document.getElementById('gameModal');
        const c = document.getElementById('innerGameContent');
        const t = document.getElementById('modalTitle');
        const i = document.getElementById('modalIcon');
        const btn = document.getElementById('gameActionBtn');
        const extra = document.getElementById('gameExtraControls');
        const status = document.getElementById('gameStatus');

        m.classList.remove('hidden'); m.classList.add('flex');
        extra.innerHTML = ''; 
        extra.classList.add('hidden');
        status.innerText = "READY TO PLAY";
        status.className = "bg-[#0b1820] pb-2 text-center text-xs font-mono uppercase tracking-widest text-gray-500";
        btn.onclick = () => executeGame(game);

        if (game === 'slots') {
            t.innerText = "PEPE SLOTS"; i.innerText = "üé∞";
            c.innerHTML = `<div class="text-6xl font-mono tracking-widest text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.8)]" id="slotRes">üçí üçã üçá</div>`;
        } 
        else if (game === 'dice') {
            t.innerText = "DICE"; i.innerText = "üé≤";
            c.innerHTML = `<div class="text-6xl font-bold text-white font-mono" id="diceRes">50</div><div class="text-xs text-primary mt-2 font-mono">&lt; ROLL UNDER 50 &gt;</div>`;
        }
        else if (game === 'blackjack') {
            t.innerText = "SPEED BLACKJACK"; i.innerText = "‚ö°";
            c.innerHTML = `
                <div class="flex flex-col gap-6 w-full p-4">
                    <div class="text-center bg-white/5 p-4 rounded">
                        <p class="text-[10px] text-gray-500 mb-1 uppercase">Dealer Hand</p>
                        <div id="bjDealer" class="min-h-[80px] flex items-center justify-center">
                            <div class="card-visual card-black bg-gray-800 border-2 border-gray-600">?</div>
                        </div>
                    </div>
                    <div class="text-center bg-white/5 p-4 rounded">
                        <div id="bjPlayer" class="min-h-[80px] flex items-center justify-center">
                            <div class="text-xl animate-pulse text-gray-500 font-mono">WAITING DEAL...</div>
                        </div>
                        <p class="text-[10px] text-gray-500 mt-1 uppercase">Player Hand</p>
                    </div>
                </div>`;
        }
        else if (game === 'roulette') {
            t.innerText = "ROULETTE"; i.innerText = "üé°";
            c.innerHTML = `<div class="text-6xl font-bold mb-2 text-white font-mono" id="rouletteRes">0</div>`;
            extra.classList.remove('hidden');
            extra.innerHTML = `
                <button onclick="window.rouletteChoice=0" class="bg-red-600 hover:bg-red-500 text-white p-2 rounded text-xs font-bold flex-1 border border-transparent">RED</button>
                <button onclick="window.rouletteChoice=1" class="bg-gray-800 hover:bg-gray-700 text-white p-2 rounded text-xs font-bold flex-1 border border-transparent">BLACK</button>
            `;
            window.rouletteChoice = 0; 
        }
        else if (game === 'crash') {
            t.innerText = "CRASH"; i.innerText = "üöÄ";
            c.innerHTML = `<div class="text-6xl font-bold text-primary font-mono drop-shadow-[0_0_10px_rgba(57,255,20,0.8)]" id="crashRes">1.00x</div>`;
            extra.classList.remove('hidden');
            extra.innerHTML = `<input type="number" id="crashOut" value="2.00" step="0.1" class="bg-black border border-gray-600 rounded p-2 w-24 text-center text-white outline-none font-mono" placeholder="2.0">`;
        }
        else {
            t.innerText = game.toUpperCase(); i.innerText = "üéÆ";
            c.innerHTML = `<div class="text-4xl text-gray-500 font-mono">READY</div>`;
        }
    };

    window.closeGame = () => {
        const m = document.getElementById('gameModal');
        m.classList.add('hidden'); m.classList.remove('flex');
        stopAnimation();
    };

    async function executeGame(game) {
        if(!signer) return toast("CONNECT WALLET REQUIRED", "error");
        const betInput = document.getElementById('gameBetInput').value;
        const bet = ethers.utils.parseUnits(betInput, 18);
        const status = document.getElementById('gameStatus');
        const btn = document.getElementById('gameActionBtn');

        btn.disabled = true; btn.innerText = "AUTH...";
        status.innerText = "CHECKING ALLOWANCE...";

        try {
            const spender = game === 'blackjack' ? ADDR.BLACKJACK : ADDR.INSTANT;
            const allow = await contracts.token.allowance(address, spender);
            if(allow.lt(bet)) {
                const tx = await contracts.token.approve(spender, ethers.constants.MaxUint256);
                await tx.wait();
            }

            btn.innerText = "TX PENDING...";
            let tx;

            if (game === 'slots') tx = await contracts.instant.playSlots(bet);
            else if (game === 'blackjack') tx = await contracts.blackjack.placeBet(bet);
            else if (game === 'roulette') tx = await contracts.instant.playRoulette(bet, window.rouletteChoice || 0);
            else if (game === 'dice') tx = await contracts.instant.playDice(bet, 50); 
            else if (game === 'plinko') tx = await contracts.instant.playPlinko(bet);
            else if (game === 'mines') tx = await contracts.instant.playMines(bet, 3); 
            else if (game === 'crash') {
                const out = document.getElementById('crashOut').value;
                const mult = Math.floor(parseFloat(out) * 100);
                tx = await contracts.instant.playCrash(bet, mult);
            }
            else if (game === 'keno') tx = await contracts.instant.playKeno(bet);

            if (game !== 'blackjack') startAnimation(game);
            
            status.innerText = "WAITING FOR BLOCKCHAIN CONFIRMATION...";
            const receipt = await tx.wait(); 
            
            stopAnimation();

            if(game !== 'blackjack') {
                const event = receipt.events.find(e => e.event); 
                if (event) {
                    const args = event.args;
                    if(game === 'dice') showRes(args.payout, `ROLLED: ${args.rolled}`, 'diceRes', args.rolled);
                    else if(game === 'slots') showRes(args.payout, `SYMBOLS: ${args.outcome.join('-')}`, 'slotRes', `${emoji(args.outcome[0])} ${emoji(args.outcome[1])} ${emoji(args.outcome[2])}`);
                    else if(game === 'roulette') showRes(args.payout, `RESULT: ${args.roll} (${args.color.toUpperCase()})`, 'rouletteRes', args.roll);
                    else if(game === 'plinko') showRes(args.payout, `BUCKET: ${args.slot}`);
                    else if(game === 'crash') { const c = (args.crashPoint/100).toFixed(2); showRes(args.payout, `CRASHED @ ${c}x`, 'crashRes', c+"x"); }
                    else if(game === 'mines') showRes(args.payout, args.exploded ? "BOOM!" : "SAFE");
                    else if(game === 'keno') showRes(args.payout, `MATCHES: ${args.matches}`);
                }
                updateUI();
            } else {
                status.innerText = "WAITING FOR DEALER...";
            }

        } catch(e) {
            console.error(e);
            stopAnimation();
            status.innerText = "ERROR: TRANSACTION FAILED";
            status.className = "bg-[#0b1820] pb-2 text-center text-xs font-mono uppercase tracking-widest text-red-500";
            btn.disabled = false; btn.innerText = "PLAY";
            toast("TX Failed", "error");
        }
    }

    function generateHandFromScore(targetScore) {
        const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
        const cards = [];
        let currentSum = 0;
        if (targetScore === 21) return [{val:'A', s:suits[0]}, {val:'K', s:suits[1]}];
        if (targetScore > 21) return [{val:'10', s:suits[2]}, {val:'10', s:suits[3]}, {val:'5', s:suits[0]}];

        while(currentSum < targetScore) {
            let diff = targetScore - currentSum;
            let val = diff > 10 ? 10 : diff;
            if (currentSum === 0 && diff > 10) val = Math.floor(Math.random() * 9) + 2;
            if (currentSum + val > targetScore) val = targetScore - currentSum;
            currentSum += val;
            let displayVal = val.toString();
            if (val === 1 || val === 11) displayVal = 'A';
            if (val === 10) displayVal = ['10', 'J', 'Q', 'K'][Math.floor(Math.random()*4)];
            cards.push({ val: displayVal, s: suits[Math.floor(Math.random() * 4)] });
        }
        return cards;
    }

    function renderCards(elementId, score) {
        const container = document.getElementById(elementId);
        const hand = generateHandFromScore(score);
        let html = `<div class="flex gap-2 justify-center">`;
        hand.forEach(c => {
            const isRed = (c.s === '‚ô•' || c.s === '‚ô¶');
            const colorClass = isRed ? 'card-red' : 'card-black';
            html += `<div class="card-visual ${colorClass}"><span>${c.val}</span><span class="text-xs">${c.s}</span></div>`;
        });
        html += `</div><div class="text-xs mt-2 text-gray-400 font-mono">SCORE: ${score}</div>`;
        container.innerHTML = html;
    }

    function listenForWins() {
        if(!contracts.blackjack) return;
        contracts.blackjack.on("GameFinished", (p, won, pay, dScore, pScore) => {
            if(p == address) {
                renderCards('bjDealer', dScore);
                renderCards('bjPlayer', pScore);
                showRes(pay, won ? "YOU WON!" : "DEALER WINS");
            }
        });
    }

    function emoji(num) {
        const map = ['üçí','üçã','üçá','üçâ','üîî','üíé','7Ô∏è‚É£','üé±','üëë','ü™ô'];
        return map[num] || num;
    }

    function showRes(payout, text, elemId = null, elemVal = null) {
        stopAnimation();
        const btn = document.getElementById('gameActionBtn');
        const status = document.getElementById('gameStatus');
        btn.disabled = false; btn.innerText = "PLAY AGAIN";
        
        const payVal = ethers.BigNumber.from(payout);
        const won = payVal.gt(0);
        const profit = ethers.utils.formatUnits(payVal, 18);
        
        status.innerText = text + (won ? ` (+${parseFloat(profit).toFixed(0)} PBJ)` : "");
        status.className = "bg-[#0b1820] pb-2 text-center text-xs font-mono uppercase tracking-widest " + (won ? "text-primary" : "text-red-500");

        if(elemId && elemVal) document.getElementById(elemId).innerText = elemVal;

        if(won) {
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: ['#00E701', '#ffffff'] });
            updateUI(); 
        }
    }

    window.mintNFT = async (id) => {
        if(!signer) return toast("Connect Wallet", "error");
        try {
            const info = await contracts.nft.tierInfo(id);
            const allow = await contracts.token.allowance(address, ADDR.NFT);
            if(allow.lt(info.price)) await (await contracts.token.approve(ADDR.NFT, ethers.constants.MaxUint256)).wait();
            await (await contracts.nft.mint(id, 1)).wait();
            toast("MINT SUCCESSFUL"); loadUserData(); updateUI();
        } catch(e) { toast("MINT FAILED", "error"); }
    };
    window.stakeNFT = async (id) => { try { await (await contracts.nft.stake(id, 1)).wait(); loadUserData(); toast("STAKED SUCCESSFULLY"); } catch(e){} };
    window.unstakeNFT = async (id) => { try { await (await contracts.nft.unstake(id, 1)).wait(); loadUserData(); toast("UNSTAKED SUCCESSFULLY"); } catch(e){} };
    window.claimRewards = async () => { try { await (await contracts.nft.claim()).wait(); toast("REWARDS CLAIMED"); loadUserData(); } catch(e){} };

    window.loadUserData = async () => {
        if(!signer) return;
        const list = document.getElementById('inventory-list');
        list.innerHTML = '';
        let totalStaked = 0, dailyYield = 0;
        const tiers = ["COMMON", "UNCOMMON", "RARE", "EPIC", "LEGEND"];
        const rates = [50, 120, 350, 800, 2000];

        for(let i=0; i<5; i++) {
            // Simulated local logic for UI demo if contract call fails or empty
            try {
                const bal = await contracts.nft.balanceOf(address, i);
                const staked = await contracts.nft.getStakedBalance(address, i);
                totalStaked += parseInt(staked);
                dailyYield += parseInt(staked) * rates[i];

                if(bal > 0) list.innerHTML += `<div class="flex justify-between bg-gray-900 p-2 rounded mb-1 border-l-2 border-gray-600"><span class="text-xs text-white">${tiers[i]} (${bal})</span><button onclick="stakeNFT(${i})" class="text-[10px] text-primary hover:text-white">STAKE >></button></div>`;
                if(staked > 0) list.innerHTML += `<div class="flex justify-between bg-green-900/20 p-2 rounded mb-1 border-l-2 border-primary"><span class="text-xs text-primary">${tiers[i]} (STAKED)</span><button onclick="unstakeNFT(${i})" class="text-[10px] text-white hover:text-red-400"><< UNSTAKE</button></div>`;
            } catch(e) {}
        }
        document.getElementById('total-staked').innerText = totalStaked + " NFT";
        document.getElementById('daily-yield').innerText = dailyYield + " PBJ/d";
        try {
            const rew = await contracts.nft.getPendingRewards(address);
            document.getElementById('pending-rewards').innerText = parseFloat(ethers.utils.formatUnits(rew, 18)).toFixed(2);
        } catch(e) {}
    };

    document.getElementById('buyInput').addEventListener('input', (e) => {
        const v = e.target.value;
        if(v) document.getElementById('receiveInput').value = (v * 1000000).toFixed(0);
    });
    document.getElementById('buyBtn').addEventListener('click', async () => {
        if(!signer) return alert("Connect");
        try { await (await contracts.presale.buyTokens({value:ethers.utils.parseEther(document.getElementById('buyInput').value)})).wait(); alert("Bought!"); updateUI(); } catch(e){}
    });

    // 5 Day Presale Countdown Logic
    let target = localStorage.getItem('pEnd');
    if(!target || new Date(target) < new Date()) { target = Date.now() + (5 * 24 * 60 * 60 * 1000); localStorage.setItem('pEnd', target); }
    setInterval(() => {
        const d = target - Date.now();
        if(d>0) {
            document.getElementById('d').innerText = Math.floor(d/86400000);
            document.getElementById('h').innerText = Math.floor((d%86400000)/3600000);
            document.getElementById('m').innerText = Math.floor((d%3600000)/60000);
            document.getElementById('s').innerText = Math.floor((d%60000)/1000);
        }
    }, 1000);

    // 2 Hour Bonus Timer Logic
    let bonusTarget = localStorage.getItem('bEnd');
    if(!bonusTarget || new Date(bonusTarget) < new Date()) { bonusTarget = Date.now() + (2 * 60 * 60 * 1000); localStorage.setItem('bEnd', bonusTarget); }
    setInterval(() => {
        let diff = bonusTarget - Date.now();
        if(diff <= 0) {
            bonusTarget = Date.now() + (2 * 60 * 60 * 1000); 
            localStorage.setItem('bEnd', bonusTarget);
        }
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        document.getElementById('bonusTimer').innerText = 
            `0${hours}:${minutes < 10 ? '0'+minutes : minutes}:${seconds < 10 ? '0'+seconds : seconds}`;
    }, 1000);

  </script>
</body>
</html>
